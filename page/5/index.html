<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>KyleCe</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="KyleCe">
<meta property="og:url" content="https://github.com/KyleCe/kylece.github.io/page/5/index.html">
<meta property="og:site_name" content="KyleCe">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="KyleCe">
  
    <link rel="alternate" href="/atom.xml" title="KyleCe" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/avatar.jpg">
  <link rel="apple-touch-icon" href="/css/images/avatar.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>
  <script src="/js/bootstrap.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    <link rel="stylesheet" href="/css/home.css" >
  

  

  

  
  
  

</head>



  <body>


  
    <header id="header">

	<!-- èƒŒæ™¯å›¾æ¨¡å¼ -->
	

    
      <div id="intrologo" class="intro-logo" style="background-position:center; background-repeat:no-repeat; background-image: url(); background-size: auto 100%;">

      <!-- Support rolling -->  
        
        <section class="awSlider">
          <div class="carousel slide carousel-fade " data-ride="carousel">

            <!-- Wrapper for slides -->
            <div class="carousel-inner">
               
                  
                    <div class="item active">
                  
                    <img id="carousel-img0" src="/css/images/home-bg.jpg">
                  </div>

                  <!-- è‡ªé€‚åº”å¤§å›¾ -->
                  <script>
                      var img0 = new Image();
                      var imageTag0 = document.getElementById("carousel-img0");
                      img0.src = imageTag0.src;
                      img0.onload=function(){
                        if (img0.width / img0.height <= document.body.clientWidth / document.body.clientHeight) {
                          imageTag0.style.width = document.body.clientWidth + "px";
                        } else {
                          imageTag0.style.height = document.body.clientHeight + "px";
                          imageTag0.style.marginLeft = -(document.body.clientHeight * img0.width / img0.height - document.body.clientWidth) / 2 + "px";
                        }
                      };
                  </script>
                
                  
                    <div class="item">
                  
                    <img id="carousel-img1" src="/css/images/sample.jpg">
                  </div>

                  <!-- è‡ªé€‚åº”å¤§å›¾ -->
                  <script>
                      var img1 = new Image();
                      var imageTag1 = document.getElementById("carousel-img1");
                      img1.src = imageTag1.src;
                      img1.onload=function(){
                        if (img1.width / img1.height <= document.body.clientWidth / document.body.clientHeight) {
                          imageTag1.style.width = document.body.clientWidth + "px";
                        } else {
                          imageTag1.style.height = document.body.clientHeight + "px";
                          imageTag1.style.marginLeft = -(document.body.clientHeight * img1.width / img1.height - document.body.clientWidth) / 2 + "px";
                        }
                      };
                  </script>
                
                  
                    <div class="item">
                  
                    <img id="carousel-img2" src="https://source.unsplash.com/collection/954550/1920x1080">
                  </div>

                  <!-- è‡ªé€‚åº”å¤§å›¾ -->
                  <script>
                      var img2 = new Image();
                      var imageTag2 = document.getElementById("carousel-img2");
                      img2.src = imageTag2.src;
                      img2.onload=function(){
                        if (img2.width / img2.height <= document.body.clientWidth / document.body.clientHeight) {
                          imageTag2.style.width = document.body.clientWidth + "px";
                        } else {
                          imageTag2.style.height = document.body.clientHeight + "px";
                          imageTag2.style.marginLeft = -(document.body.clientHeight * img2.width / img2.height - document.body.clientWidth) / 2 + "px";
                        }
                      };
                  </script>
                
            </div>

            <!-- Controls -->
            <a class="left carousel-control" href=".carousel" role="button" data-slide="prev">
              <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
              <span class="sr-only">Geri</span>
            </a>
            <a class="right carousel-control" href=".carousel" role="button" data-slide="next">
              <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
              <span class="sr-only">Ä°leri</span>
            </a>
          </div>
        </section>
        <script>
          $('section.awSlider .carousel').carousel({
              pause: '',
              interval: 5000
          });
          var startImage = $('section.awSlider .item.active > img').attr('src');
          $('section.awSlider .carousel').on('slid.bs.carousel', function () {
              var bscn = $(this).find('.item.active > img').attr('src');
              $('section.awSlider > img').attr('src', bscn);
          });
        </script>
      

    
 


    <canvas width="100%" height="100%"></canvas>
    <script>
      var c = document.getElementsByTagName('canvas')[0],
          x = c.getContext('2d'),
          w = window.innerWidth,
          h = window.innerHeight,
          pr = window.devicePixelRatio || 1,
          f = 90,
          q,
          m = Math,
          r = 0,
          u = m.PI*2,
          v = m.cos,
          z = m.random
      c.width = w*pr
      c.height = h*pr
      x.scale(pr, pr)
      x.globalAlpha = 0.6

      <!-- æŠ˜çº¿PolylineèƒŒæ™¯ -->
      
    </script>
    

    
      <div id="homelogo" class="homelogo" style="background: rgba(255,255,255,1);"> 
    

        
          <div class="homelogoback"  style="border: 1px solid #404040;" >
            <h1><a href="#content" id="logo">KyleCe</a></h1>
            <h3></h3>
            <h5>KyleCe</h5>
            <!-- <p><a href="https://github.com/iTimeTraveler" target="_blank">Github</a></p> -->
          </div>
        
    
    </div>
  </div>

  <!-- è‡ªé€‚åº”ä¸»é¡µèƒŒæ™¯å¤§å›¾ -->
  

 <!-- home_logo_imageå±…ä¸­ -->
 
    <script>
        var homelogodiv = document.getElementById("homelogo");
        if (document.all.homelogo.offsetWidth > document.body.clientWidth) {
          homelogodiv.style.width = document.body.clientWidth + "px";
          homelogodiv.style.marginLeft = document.body.clientWidth * -0.5 + "px";
        } else {
          homelogodiv.style.width = homelogodiv.clientWidth  + "px";
          homelogodiv.style.marginLeft = (homelogodiv.clientWidth)  * -0.5 + "px";
        }
    </script>
  

  <div class="intro-navigate">
      <p class="navigater-list">
        
          <a id="beautifont" class="main-nav-link" href="/">é¦–é¡µ</a>
        
          <a id="beautifont" class="main-nav-link" href="/archives">å½’æ¡£</a>
        
          <a id="beautifont" class="main-nav-link" href="/categories">åˆ†ç±»</a>
        
          <a id="beautifont" class="main-nav-link" href="/tags">æ ‡ç­¾</a>
        
          <a id="beautifont" class="main-nav-link" href="/about">å…³äº</a>
        
      </p>
  </div>

</header>
  
  <div id="container">
    <div id="wrap">
      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;">
  
    <article id="post-æŠ€æœ¯/Android/ã€Androidã€‘JNI-Tips-æè¦"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘JNI-Tips-æè¦/">JNI-Tips-æè¦</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘JNI-Tips-æè¦/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>å¼•ï¼š<br>é¡¹ç›®éœ€è¦ç”¨åˆ°JNIï¼Œå®é™…ä¸Šè¿˜éœ€è¦åœ¨nativeè·ŸJavaä¹‹é—´å†™ä¸€äº›ä»£ç ï¼Œæ¥è¿æ¥äºŒä½ï¼Œéœ€è¦åšè¿›ä¸€æ­¥äº†è§£ã€‚æœ¬æ–‡ä¸»è¦å¯¹å®˜æ–¹çš„JNI Tipsåšä¸€äº›ç®€å•çš„å…³é”®æå–<br>å‚è€ƒï¼š<br><a href="">JNI Tips</a></p>
</blockquote>
<hr>
<p><a href="https://www.evernote.com/l/ARunDTJCHX9AQ5Zm7URUjILWW2iFBUVWGRc" target="_blank" rel="noopener">Evernoteè¿æ¥</a></p>
<p><a href="https://www.evernote.com/shard/s283/sh/a70d3242-1d7f-4043-9666-ed44548c82d6/5b68850545561917/res/ba76fe6f-7df9-41f8-a0cd-1f0dcbe4349c/JNI%20Tips.xmind" target="_blank" rel="noopener">XMind æ–‡æ¡£ä¸‹è½½</a></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1481332-ce0301d2d61fe60b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="JNI Tips.png"></p>
<p>æ–‡æœ¬ï¼š</p>
<p>JNI Tips</p>
<p>definition<br>  Java Native Interface<br>  how it works<br>    <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/jniTOC.html" target="_blank" rel="noopener">http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/jniTOC.html</a><br>JavaVM and JNIEnv<br>  JavaVM<br>    one process can only create one JavaVM in Android<br>  JNIEnv<br>    provides most of JNI functions. Your native functions all receive a JNIEnv as first argument<br>    used for thread-local, so you cannot share a JNIEnv between threads (GetEnv can be used to discover the threadâ€™s JNIEnv when no other way)<br>Threads<br>  a thread will have no JNIEnv unless itâ€™s attached, before this it cannot make JNI calls (all threads are Linux threads, scheduled by the kernel)<br>  Threads attached through JNI must call DetachCurrentThread before they exit<br>jclass, jmethodID, and jfieldID<br>  steps to access an objectâ€™s field from native code<br>    FindClass:â€”&gt; get the class object reference for the class<br>    GetFieldID:â€”&gt;Get the field ID for the field with GetFieldID<br>    GetIntField:â€”&gt;Get the contents of the field with something appropriate<br>  call a methodâ€”&gt; get a class object reference and then a method ID<br>  itâ€™s useful to look the values up once and cache the results in your native code. Because there is a limit of one JAVAVM per process<br>  if want to cache IDs when a class is loaded, add a piece of code that allow the native code to cache field offsets<br>Local and Global Reference<br>  almost every object returned by a JNI function is a â€œlocal referenceâ€â€”&gt;itâ€™s valid for the duration of the current native method in the current thread. Even if the object itself continues to live on after the native method returns, the reference is not valid<br>  the only way to get non-local references is via the functions NewGlobalRef and NewWeakGlobalRef (the global reference is guaranteed to be valid until you call DeleteGlobalRef)<br>  to see if two reference refer to the same object, you must use the IsSameObject function, never use == in native code<br>  jfieldIDs, jmethod are opaque types, not object references, should not be passed to NewGlobalRef<br>  if you attach a native thread with AttachCurrentThread, the code you are running will never automatically free local references until the thread detaches. Any local references you create will have to be deleted manually.<br>UTF-8 and UTF-16 Strings<br>  java use UTF-16, JNI provides methods that work with Modified UTF-8 as well.<br>  you cannot pass arbitrary UTF-8 data to JNI and expect it to work correctly<br>  Android currently does not require a copy in GetStringChars,however GetStringUTFChars requires an allocation and a conversion to UTF-8. UTF-16 strings are not zero-terminated, \u0000 is allowed, so you need to hang on to the string length like jchar pointer<br>  Donâ€™t forget to Release the strings you Get. the string functions return jchar<em> or jbyte</em><br>  Data passed to NewStringUTF must be in Modified UTF-8 format<br>Primitive Arrays<br>  You must Release every array you Get<br>  release mode arguments alternative values<br>    0<br>        buffer freed<br>    JNI_COMMIT<br>        do nothing/ buffer not freed<br>    JNI_ABORT<br>        buffer freed, Earlier wirtes are not aborted<br>Region calls<br>  advantages<br>    reducing overhead by reducing JNI call requirements<br>    do not require pinning or extra data copies<br>    reduces the risk of programmer errorâ€“&gt; no risk of forgetting to call Release<br>Exception<br>  your must not call JNI functions while an exception is pending, except several special kinds of API: delete/ exception process/stack process/ release process â€¦<br>Extended Checking<br>  JNI does very little error checking ~~!<br>  Android offers a mode called CheckJNI<br>    array, bad pointers, Class names, Critical call,Direct ByteBuffers, Exceptions, JNIEnv<em>s, jmethodIDs, References,Release modes, Type safety, UTF-8<br>Native Libraries<br>  steps<br>    call System.loadLibrary<br>    provide a native function : jint JNI_OnLoad(JavaVM</em> vm void* reserved)<br>    in JNI_OnLoad, register all your native methods<br>64-bit Considerations<br>  you need to stash your native pointers in a long field rather than an int<br>Unsupported Features/ Backwards Compatibility<br>  Define class<br>  dynamic lookup of native functions<br>  detaching threads<br>  weak global references<br>  Local references<br>  determining reference type with GetObjectRefType</p>
<hr>
<p>å…³æ³¨å…¬ä¼—å·â€œå¤•è¯†â€ï¼Œé›•åˆ»æ—¶å…‰ï¼Œä¸è´Ÿæµå¹´<br><img src="http://upload-images.jianshu.io/upload_images/1481332-c461a8ddbf8cf08e.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JNI/">JNI</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/Android/ã€Androidã€‘Clean-Architecture--åˆæ"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘Clean-Architecture--åˆæ/">Clean-Architecture--åˆæ</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘Clean-Architecture--åˆæ/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>æœ¬ç¯‡æ‰¿æ¥ <a href="http://www.jianshu.com/p/43fcba217459" target="_blank" rel="noopener">_ä¸Šæ–‡_</a><br>å‚è€ƒï¼š</p>
<ol>
<li><a href="https://fernandocejas.com/2014/09/03/architecting-android-the-clean-way/" target="_blank" rel="noopener">Architecting Androidâ€¦The clean way?</a></li>
<li><a href="https://github.com/android10/Android-CleanArchitecture">Clean Architeture Sample -By android10</a></li>
</ol>
</blockquote>
<hr>
<p>è‰²å½©ç®€åŒ–åçš„ç»“æ„å›¾ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/1481332-fe3d6bffa3c4e274.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ease_clean_architecture.png"></p>
<p>æƒ³è¡¨è¾¾çš„æ˜¯ä¾èµ–å±‚çº§ï¼Œä»è¿™å¹…å›¾å¯ä»¥çœ‹å‡ºï¼Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»åœ¨ç†æƒ³æƒ…å†µä¸‹æ˜¯æ¸…æ™°çš„ï¼Œä¹Ÿä¸å­˜åœ¨å¤šç»´åº¦ç›¸äº’ä¾èµ–çš„é—®é¢˜ï¼Œæœ€å¤–å±‚UIä¾èµ–Presenterå±‚ï¼ŒPresenterå±‚åˆä¾èµ–Use Caseså±‚ï¼Œä»¥æ­¤ç±»æ¨â€¦  ï¼ˆ<strong>æ¯å±‚çš„ä¾èµ–åªèƒ½å‘å†…æ”¶ç¼©</strong>ï¼‰</p>
<p><em>å½“ç„¶ï¼Œè¿™é‡Œçš„å±‚çº§å†…æ¶µåªæ˜¯ä¸¾ä¾‹ç¤ºæ„ï¼Œåœ¨å®é™…ä¸šåŠ¡ä¸­éœ€è¦æ ¹æ®éœ€è¦è®¾å®šå„å±‚æ ¸å¿ƒï¼Œå±‚çº§æ•°ä¹Ÿå¯é€‚é‡è°ƒæ•´ï¼Œæ•´ä¸ªæ¶æ„å¼ºè°ƒçš„åªæ˜¯ä¸€ç§ä¾èµ–æ”¶ç¼©çš„æ€æƒ³</em></p>
<hr>
<blockquote>
<p>ä¸€ä¸ªä¾‹å­ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/1481332-2b039b1c3b887476.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="clean_architecture_android_schema.png"><br>æ¶æ„åˆ†ä¸ºä¸‰å±‚ï¼š</p>
<pre><code>1. Presentation
2. Domain
3. Data
</code></pre><hr>
<p><strong>Presentation</strong><br><img src="http://upload-images.jianshu.io/upload_images/1481332-d9f5b06f606cdb68.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="clean_architecture_mvp.png"><br>è¦ç‚¹å³æ˜¯å¤§å®¶ç†ŸçŸ¥çš„MVPä¸€ç±»ï¼›<br>Androidçš„ä»£ç åº”è¯¥å…¨éƒ¨éƒ½å‡ºç°åœ¨è¿™ä¸€å±‚</p>
</blockquote>
<blockquote>
<p><strong>Domain</strong><br><img src="http://upload-images.jianshu.io/upload_images/1481332-f216b0617d67dbdc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="clean_architecture_domain.png"><br>ä¸šåŠ¡é€»è¾‘å±‚ï¼Œä»£ç åº”è¯¥æ˜¯çº¯ç²¹çš„JAVA APIï¼Œä¸Androidæ— å…³</p>
</blockquote>
<blockquote>
<p>Data<br><img src="http://upload-images.jianshu.io/upload_images/1481332-e536090a22ea7452.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="clean_architecture_data.png"><br>è¿™ä¸€å±‚ä¸»è¦æ˜¯å¤„ç†æ•°æ®ä¸šåŠ¡</p>
</blockquote>
<p>å‡ å¼ å›¾å…¶å®èƒ½å¾ˆæ¸…æ¥šåœ°è¯´æ˜Clean Architectureçš„ç«‹æ„ã€ç”¨æ³•</p>
<hr>
<p>å…³æ³¨å…¬ä¼—å·â€œå¤•è¯†â€ï¼Œé›•åˆ»æ—¶å…‰ï¼Œé›•åˆ»æ€ç»´<br><img src="http://upload-images.jianshu.io/upload_images/1481332-c461a8ddbf8cf08e.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AndroidStudio/">AndroidStudio</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/Android/ã€Androidã€‘AS-ä¾èµ–libå»ºè®®ã€å¾®ä¿¡QRCodeç™»é™†"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘AS-ä¾èµ–libå»ºè®®ã€å¾®ä¿¡QRCodeç™»é™†/">AndroidAS-ä¾èµ–libå»ºè®®ã€å¾®ä¿¡QRCodeç™»é™†</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘AS-ä¾èµ–libå»ºè®®ã€å¾®ä¿¡QRCodeç™»é™†/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>åªæœ‰ä¸€æ¡ï¼š<br>èƒ½download libå°±downloadä¹‹åæ”¾åˆ°libs dirå§ï¼Œä¸ç„¶ä¼™ä¼´ä»¬syncèµ·æ¥å¤ªè´¹æ—¶é—´äº†ï¼›</p>
</blockquote>
<blockquote>
<p>è¿™æ ·çš„è¯ï¼Œæ³¨æ„å®šæœŸæ£€æŸ¥å„libç‰ˆæœ¬å°±å¥½</p>
</blockquote>
<p>ä»Šæ—¥å…¥å‘ï¼šå¾®ä¿¡ç™»é™†ï¼ˆæ‰«æäºŒç»´ç ç™»é™†ï¼‰<br><a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419317851&amp;token=&amp;lang=zh_CN" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥ï¼šå®˜æ–¹API doc</a></p>
<p>æ€»ç»“ä¸€ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>è·å–äºŒç»´ç ï¼ˆQRCodeï¼‰</li>
<li>ç”¨æˆ·æˆæƒåï¼Œé‡å®šå‘æ¥å£ä¼šæ¥å—åˆ°å¸¦codeçš„è¯·æ±‚<code>--&gt;code [get]</code></li>
<li><p>æ‹¿ç€ä¸Šä¸€æ­¥çš„<code>code</code>ï¼Œè¿å¸¦åœ¨å¾®ä¿¡æ³¨å†Œæ—¶çš„appidã€secretä¸€èµ·å»è¯·æ±‚access_token <code>--&gt;access_tokenã€openid[get]</code></p>
</li>
<li><p><strong>å¤§åŠŸå‘Šæˆ</strong>ï¼šæ‹¿ç€ä¸Šä¸€æ­¥å¾—åˆ°çš„tokenè·Ÿopenidï¼Œå°±å¯ä»¥è¯·æ±‚ä½ æƒ³è¦çš„æ•°æ®å•¦</p>
</li>
</ol>
<p>æ—¶åºå›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1481332-c7db4bd0ffa26d19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="wechat.png"></p>
<hr>
<p>å…³æ³¨å…¬ä¼—å·â€œå¤•è¯†â€ï¼Œé›•åˆ»æ—¶å…‰ï¼Œé›•åˆ»æ€ç»´<br><img src="http://upload-images.jianshu.io/upload_images/1481332-c461a8ddbf8cf08e.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AndroidStudio/">AndroidStudio</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/Android/ã€Androidã€‘Android-Clean-Architectureæ¨ä»‹"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘Android-Clean-Architectureæ¨ä»‹/">Android-Clean-Architectureæ¨ä»‹</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘Android-Clean-Architectureæ¨ä»‹/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a href="https://medium.com/@dmilicic/a-detailed-guide-on-developing-android-apps-using-the-clean-architecture-pattern-d38d71e94029#.c9wgdy880" target="_blank" rel="noopener">A detailed guide on developing Android apps using the Clean Architecture pattern</a></p>
</blockquote>
<p>æœ¬æ–‡ä¸ºClean Architectureåœ¨Android Appå¼€å‘ä¸­çš„guideline</p>
<hr>
<p>Bobå¤§å”æ‰€ä½œClean Architectureç»“æ„å›¾å¦‚ä¸‹ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/1481332-d8356f0cf9fa5894.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="clean architecture.jpg"></p>
<p>ä½¿ç”¨Clean Architectureå…·æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š</p>
<pre><code>1. ç‹¬ç«‹äºFrameworks
2. æ˜“æµ‹è¯•.
3. ç‹¬ç«‹äºUI.
4. ç‹¬ç«‹äºDatabase.
5. ç‹¬ç«‹äºå¤–éƒ¨ agency.
</code></pre><hr>
<p>Androidåº”ç”¨å¸¸ç”¨çš„3å±‚æ¶æ„ï¼š</p>
<pre><code>Outer: Implementation layer  å®ç°å±‚
Middle: Interface adapter layer æ¥å£é€‚é…å±‚
Inner: Business logic layer ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆâ€”â€”åº”å¯ç”¨ç‹¬ç«‹äºAndroidçš„æµ‹è¯•ç”¨ä¾‹è¿›è¡Œæµ‹è¯•ï¼‰
</code></pre><p>åˆ†åˆ«ä¸ºï¼š</p>
<ol>
<li><strong>Outer layer</strong><br>UIã€Storageã€Networkç­‰</li>
<li><strong>Middle layer</strong><br>Presentersã€Converters        </li>
<li><strong>Inner layer</strong><br>POJOsã€Interactorsã€Modelã€Repositoriesã€Executors</li>
</ol>
<hr>
<p>è¯†åˆ«äºŒç»´ç ï¼Œå…³æ³¨å…¬ä¼—å·â€œå¤•è¯†â€<br><img src="http://upload-images.jianshu.io/upload_images/1481332-c461a8ddbf8cf08e.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Architecture/">Architecture</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/Android/ã€Androidã€‘ASæ·»åŠ JNIæ”¯æŒ"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘ASæ·»åŠ JNIæ”¯æŒ/">ASæ·»åŠ JNIæ”¯æŒ</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/ã€Androidã€‘ASæ·»åŠ JNIæ”¯æŒ/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p><em>JNIå…¥å‘</em></p>
</blockquote>
<blockquote>
<p>ç´¢å¼•ï¼š</p>
<ol>
<li>æ—§  NDK  ä½¿ç”¨å§¿åŠ¿(AS 2.2 ä»¥ä¸‹ <a href="https://codelabs.developers.google.com/codelabs/android-studio-jni/index.html?index=..%2F..%2Findex#2" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥ï¼šCreate hello-JNI with android studio</a>)</li>
<li>æ–°  NDK  ä½¿ç”¨æ–¹æ³•(AS 2.2åŠä»¥ä¸Š <a href="https://developer.android.google.cn/studio/projects/add-native-code.html" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥ï¼šAdd C and C++ Code to Your Project</a>)</li>
</ol>
</blockquote>
<blockquote>
<p>å‚è€ƒï¼š<br><a href="https://developer.android.google.cn/training/articles/perf-jni.html?hl=zh-cn" target="_blank" rel="noopener">JNI Tips</a><br>(é“¾æ¥å‡éœ€VPN)</p>
</blockquote>
<hr>
<h4 id="æ—§-NDK-buildï¼š"><a href="#æ—§-NDK-buildï¼š" class="headerlink" title="æ—§  NDK-buildï¼š"></a>æ—§  NDK-buildï¼š</h4><p>ç®€å•æ¥è¯´åˆ†è¿™ä¹ˆå‡ æ­¥ï¼š</p>
<ol>
<li>æ·»åŠ ndkåº“æ”¯æŒ</li>
<li><p>åœ¨ gradle.propertiesä¸­æ·»åŠ ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android.useDeprecatedNdk=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ appçº§build.gradleä¸­æ·»åŠ ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  defaultConfig &#123;</span><br><span class="line">        ndk &#123;</span><br><span class="line">            moduleName <span class="string">"test-jni"</span> <span class="comment">// name the jni lib you want to add</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºload é™æ€å—ï¼Œæ·»åŠ å¾…å®ç°native api</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JniTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">"test-jni"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title">getMsgFromJni</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>åœ¨ ç›®æ ‡apiæ‰€åœ¨è¡Œåœç•™ä¸€ä¼šï¼Œä¼šå‡ºç°çº¢è‰²ç¯æ³¡æç¤ºæŒ‰é’®ï¼Œç‚¹å‡»å›¾æ ‡ï¼Œä¼šæœ‰<code>Create Function Java_%full class name%_getMsgFromJni</code>é€‰é¡¹å‡ºç°ï¼›ç‚¹å‡»ä¹‹åä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸javaç›®å½•å¹¶åˆ—çš„cppç›®å½•ï¼Œå¹¶åœ¨ç›®å½•ä¸‹ç”Ÿæˆ<code>test-jni.c</code>æ–‡ä»¶<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;jni.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">JNIEXPORT jstringJNICALL</span><br><span class="line">Java_com_zealens_face_jnitest_JniTest_getMsgFromJni(JNIEnv</span><br><span class="line">*env, jobject instance)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO</span></span><br><span class="line"><span class="keyword">return</span> (*env)-&gt;NewStringUTF(env, returnValue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¯´æ˜ï¼š</p>
<ol>
<li>å¯¹äºç¬¬3è¡Œä»£ç ï¼š<br>ASç”Ÿæˆçš„ä»£ç æœ‰é”™è¯¯ï¼Œéœ€å°†JNICALLä¸å‰é¢çš„jstringéš”å¼€ï¼›</li>
<li>å°†returnValueä¿®æ”¹ä¸ºå¸¸é‡å€¼ï¼ˆegï¼šâ€helloâ€ï¼‰</li>
</ol>
</blockquote>
<p>è‡³æ­¤ï¼Œbuildä¹‹åè°ƒç”¨APIå°±èƒ½å¾—åˆ°åˆšæ‰å¡«å…¥çš„helloå€¼ã€‚</p>
<hr>
<p>####æ–°CMake</p>
<blockquote>
<p>ASç°åœ¨é»˜è®¤çš„C++å·¥å…·å·²ç»ä¿®æ”¹ä¸ºCMakeï¼ˆéœ€è¦åœ¨SDK-Toolsä¸­å®‰è£…CMakeã€LLDBã€NDKï¼‰ï¼Œæ—§çš„ndk-buildåº“ä¹Ÿå¯ä»¥æ‰‹åŠ¨å¯¼å…¥</p>
</blockquote>
<blockquote>
<p>å‡†å¤‡å·¥ä½œï¼š</p>
<ol>
<li>å¦‚æœæœ‰åˆ™ç§»é™¤ï¼š<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Remove this line</span></span><br><span class="line">android.useDeprecatedNdk = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<ol>
<li>install build tools</li>
</ol>
<p>ï¼ˆç•¥ï¼šåˆ›å»ºæ–°çš„C++support Applicationï¼‰</p>
<ol>
<li>å‘ç°æœ‰é¡¹ç›®æ·»åŠ C/C++ ä»£ç ï¼š<br> a. æ–°å»ºcppç›®å½•ï¼›<br> b. æ·»åŠ cppæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span></span><br><span class="line">JNIEXPORT jstring JNICALL</span><br><span class="line">Java_%your test <span class="class"><span class="keyword">class</span> <span class="title">full</span> <span class="title">name</span>%_<span class="title">stringFromJNI</span>(</span></span><br><span class="line"><span class="class">        <span class="title">JNIEnv</span>* <span class="title">env</span>,</span></span><br><span class="line"><span class="class">        <span class="title">jobject</span> /* <span class="title">this</span> */) &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> hello = <span class="string">"Hello from C++"</span>;</span><br><span class="line">    <span class="keyword">return</span> env-&gt;NewStringUTF(hello.c_str());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æ¬²é“¾æ¥cppçš„æ ¹ç›®å½•ä¸­ï¼ˆä¸build.gradleåŒçº§ï¼‰åˆ›å»ºæ–‡ä»¶ï¼š<code>CMakeLists.txt</code>ï¼Œé”®å…¥å¦‚ä¸‹ä»£ç ï¼šï¼ˆå„APIå«ä¹‰è§<a href="https://developer.android.google.cn/studio/projects/add-native-code.html" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥æœ«å°¾éƒ¨åˆ†</a>ï¼Œæˆ– <a href="https://cmake.org/cmake/help/latest/manual/cmake-commands.7.html" target="_blank" rel="noopener">CMake command</a>ï¼‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># For more information about <span class="keyword">using</span> CMake with Android Studio, read the</span><br><span class="line"><span class="meta"># documentation: https:<span class="comment">//d.android.com/studio/projects/add-native-code.html</span></span></span><br><span class="line"></span><br><span class="line"># Sets the minimum version of CMake required to build the native library.</span><br><span class="line"></span><br><span class="line">cmake_minimum_required(VERSION <span class="number">3.4</span><span class="number">.1</span>)</span><br><span class="line"></span><br><span class="line"># Creates <span class="keyword">and</span> names a library, sets it as either STATIC</span><br><span class="line"><span class="meta"># or SHARED, and provides the relative paths to its source code.</span></span><br><span class="line"># You can define multiple libraries, <span class="keyword">and</span> CMake builds them <span class="keyword">for</span> you.</span><br><span class="line"># Gradle automatically packages shared libraries with your APK.</span><br><span class="line"></span><br><span class="line">add_library( # Sets the name of the library.</span><br><span class="line">             native-lib</span><br><span class="line"></span><br><span class="line">             # Sets the library as a shared library.</span><br><span class="line">             SHARED</span><br><span class="line"></span><br><span class="line">             # Provides a relative path to your source file(s).</span><br><span class="line">             src/main/cpp/native-lib.cpp )</span><br><span class="line"></span><br><span class="line"># Searches <span class="keyword">for</span> a specified prebuilt library <span class="keyword">and</span> stores the path as a</span><br><span class="line"><span class="meta"># variable. Because CMake includes system libraries in the search path by</span></span><br><span class="line"><span class="meta"># default, you only need to specify the name of the public NDK library</span></span><br><span class="line"><span class="meta"># you want to add. CMake verifies that the library exists before</span></span><br><span class="line"><span class="meta"># completing its build.</span></span><br><span class="line"></span><br><span class="line">find_library( # Sets the name of the path variable.</span><br><span class="line">              <span class="built_in">log</span>-lib</span><br><span class="line"></span><br><span class="line">              # Specifies the name of the NDK library that</span><br><span class="line">              # you want CMake to locate.</span><br><span class="line">              <span class="built_in">log</span> )</span><br><span class="line"></span><br><span class="line"># Specifies libraries CMake should link to your target library. You</span><br><span class="line"><span class="meta"># can link multiple libraries, such as libraries you <span class="meta-keyword">define</span> in this</span></span><br><span class="line"><span class="meta"># build script, prebuilt third-party libraries, or system libraries.</span></span><br><span class="line"></span><br><span class="line">target_link_libraries( # Specifies the target library.</span><br><span class="line">                       native-lib</span><br><span class="line"></span><br><span class="line">                       # Links the target library to the <span class="built_in">log</span> library</span><br><span class="line">                       # included in the NDK.</span><br><span class="line">                       $&#123;<span class="built_in">log</span>-lib&#125; )</span><br></pre></td></tr></table></figure>
<p>ä¹‹åï¼Œåœ¨åŒä¸€æ¨¡å—ç›®å½•ä¸Šå•å‡»å³é”®ï¼Œé€‰æ‹©<code>link c++...</code>ï¼Œé€‰ä¸­æ¬²é“¾æ¥çš„cppæ–‡ä»¶ï¼Œbuild.gradleå°±ä¼šç”Ÿæˆå¦‚ä¸‹ä»£ç ï¼šï¼ˆandroidæ¨¡å—ä¸­ï¼‰<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">externalNativeBuild &#123;</span><br><span class="line">    cmake &#123;</span><br><span class="line">        path <span class="string">"CMakeLists.txt"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ­¤æ—¶å†è°ƒç”¨ç›¸åº”APIå°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CppTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A native method that is implemented by the 'native-lib' native library,</span></span><br><span class="line"><span class="comment">     * which is packaged with this application.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title">stringFromJNI</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Used to load the 'native-lib' library on application startup.</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">"native-lib"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>pay attention to the lib name</p>
</blockquote>
<blockquote>
<p>é«˜é˜¶è®¾ç½®è¯·å‚è€ƒæ‰‹å†Œï¼Œè¿™é‡Œä¹Ÿåªæ˜¯ä»‹ç»ä¸€ä¸ªæœ€å°çš„CMakeç¯å¢ƒ</p>
</blockquote>
<hr>
<p>å…³æ³¨å…¬ä¼—å·â€œå¤•è¯†â€ï¼Œé›•åˆ»æ—¶å…‰ï¼Œé›•åˆ»æ€ç»´<br><img src="http://upload-images.jianshu.io/upload_images/1481332-c461a8ddbf8cf08e.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AndroidStudio/">AndroidStudio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JNI/">JNI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QRCode/">QRCode</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/Android/ã€Android Toolã€‘å†…å­˜å¿«ç…§åˆ†æï¼Œè‡ªåŠ¨æŠ“å–dumpæ–‡ä»¶å¹¶è½¬æ¢è„šæœ¬"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/ã€Android Toolã€‘å†…å­˜å¿«ç…§åˆ†æï¼Œè‡ªåŠ¨æŠ“å–dumpæ–‡ä»¶å¹¶è½¬æ¢è„šæœ¬/">ã€Android Toolã€‘å†…å­˜å¿«ç…§åˆ†æï¼Œè‡ªåŠ¨æŠ“å–dumpæ–‡ä»¶å¹¶è½¬æ¢è„šæœ¬</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/ã€Android Toolã€‘å†…å­˜å¿«ç…§åˆ†æï¼Œè‡ªåŠ¨æŠ“å–dumpæ–‡ä»¶å¹¶è½¬æ¢è„šæœ¬/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>æœ€æ–°å¾—åˆ°çš„Googleå†…éƒ¨æ¶ˆæ¯ï¼Œæœªæ¥è°·æ­Œåº”ç”¨å•†åº—çš„æ’åç®—æ³•å°†ä¼šæŠŠAppçš„æ€§èƒ½çº³å…¥è€ƒé‡èŒƒå›´ï¼ˆä½¿ç”¨çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼‰ï¼Œæˆ‘ä»¬å¼€å‘è€…ä¹Ÿåº”è¯¥å°†æ€§èƒ½è¿™ä¸€æŒ‡æ ‡çº³å…¥è‡ªå·±çš„æ£€æŸ¥èŒƒå›´</p>
</blockquote>
<h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>è§£å†³æŠ“å–å†…å­˜æ–‡ä»¶ï¼Œæ‹‰å–åˆ°ç”µè„‘ï¼Œæ–°å»ºæ–‡ä»¶å¤¹ï¼Œè½¬æ¢ä¸ºEclipse Memory Analyzer æ–‡ä»¶æ“ä½œç¹ççš„é—®é¢˜</p>
<h3 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h3><ul>
<li>cloneé¡¹ç›®ä¹‹åï¼Œä¸Šè¿°æµç¨‹åªéœ€è¦ğŸ‘‡çš„æŒ‡ä»¤å³å¯å®Œæˆ</li>
<li>è‡ªåŠ¨å°†è½¬æ¢çš„æ–‡ä»¶å­˜æ¡£åˆ°æ–°å»ºçš„åŒåç›®å½•ä¸‹ï¼Œé¿å…MATåˆ†æäº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶æ±¡æŸ“æ–‡æ¡£ç›®å½•</li>
<li>æ›´æ”¹ç›®å½•æˆ–è¿›ç¨‹æ—¶ï¼Œæ— éœ€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè¾“å…¥å³å¯è‡ªåŠ¨è®°å½•ä¸Šæ¬¡æ“ä½œä¹ æƒ¯</li>
<li>é‡å¤è¾“å…¥åç§°æ—¶ï¼Œä¼šè‡ªåŠ¨append æ—¶é—´åˆ°åŸæ¥åç§°ï¼Œé¿å…è¦†ç›–å†å²æ–‡ä»¶</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python GrabDump.py</span><br></pre></td></tr></table></figure>
<p>è¯»å®Œæœ¬æ–‡ï¼Œä½ å°†æ”¶è·åˆ°ä¸€ä¸ªè‡ªåŠ¨åŒ–ä¸Šè¿°æµç¨‹çš„ç®€å•project</p>
<blockquote>
<p>éœ€è¦äº†è§£ ApkåŒ…çš„å†…å­˜å ç”¨å„éƒ¨åˆ†ç»„æˆ</p>
</blockquote>
<h3 id="GitHub-åœ°å€"><a href="#GitHub-åœ°å€" class="headerlink" title="GitHub åœ°å€"></a>GitHub åœ°å€</h3><p><a href="https://github.com/KyleCe/PhonePerformanceMeasure">https://github.com/KyleCe/PhonePerformanceMeasure</a></p>
<h2 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a>å…³é”®ç‚¹</h2><p>æœ€ç»ˆçš„ä½¿ç”¨æ—¶æ ·å¼ï¼š</p>
<p><img src="../../pic_resource/grabDump.png" alt=""></p>
<h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><ul>
<li>é¦–å…ˆä½ éœ€è¦å®‰è£…Python ^_^</li>
</ul>
<ul>
<li>å¯ä»¥è¾“å…¥çš„å‚æ•°åŒ…æ‹¬ï¼š  dumpæ–‡ä»¶åã€å­˜æ”¾ç›®å½•ã€éœ€è¦æŠ“å–çš„è¿›ç¨‹å</li>
<li>ä¸‹æ¬¡è¾“å…¥æ—¶ï¼Œå¦‚æœæ²¡æœ‰å®Œå…¨è¾“å…¥ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨ä¸Šä¸€æ¬¡çš„å‚æ•°</li>
</ul>
<blockquote>
<p>ç¬¬ä¸€æ¬¡è¾“å…¥çš„æ—¶å€™è¿˜æ˜¯éœ€è¦å®Œå…¨çš„é…ç½®</p>
</blockquote>
<h3 id="å·²çŸ¥é—®é¢˜"><a href="#å·²çŸ¥é—®é¢˜" class="headerlink" title="å·²çŸ¥é—®é¢˜"></a>å·²çŸ¥é—®é¢˜</h3><p>æŠ“å–dumpæ¬¡æ•°è¿‡å¤šæ—¶ä¼šå‡ºç°adbç¼“å­˜è¯»å†™é”™è¯¯çš„é—®é¢˜ï¼Œéœ€è¦é‡å¯adbï¼ˆkill-server | start-serverï¼‰ï¼Œåç»­æ‰¾åˆ°è§£å†³æ–¹æ¡ˆä¼šåŠæ—¶æ›´æ–°åˆ°Github repository</p>
<hr>
<p>æ‰«æäºŒç»´ç ï¼Œå…³æ³¨â€œå¤•è¯†â€ï¼Œä¸€èµ·å­¦ä¹ AndroidçŸ¥è¯†ã€CSçŸ¥è¯†ï¼ŒåŠªåŠ›æˆä¸ºä¸€ä½  different thinker</p>
<p><img src="../../pic_resource/qrcode_for_wechat.jpg" alt=""></p>
<p>ç‚¹å‡»â€œé“¾æ¥â€ï¼Œè·³è½¬è‡³repoåœ°å€</p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dump/">Dump</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MemoryLeak/">MemoryLeak</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/Android/retrofit2"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/retrofit2/">retrofit2</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/retrofit2/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<blockquote>
<p>ä½œè€…ï¼š <a href="https://twitter.com/jakewharton" target="_blank" rel="noopener">Jake Wharton</a></p>
<p>åŸæ–‡å¼•è‡ªï¼š<a href="https://academy.realm.io/cn/posts/droidcon-jake-wharton-simple-http-retrofit-2/" target="_blank" rel="noopener">link</a></p>
</blockquote>
<p><a href="http://square.github.io/retrofit/" target="_blank" rel="noopener">Retrofit</a> ä½œä¸ºç®€åŒ– HTTP è¯·æ±‚çš„åº“ï¼Œå·²ç»è¿è¡Œå¤šå¹´ï¼Œ2.0ç‰ˆæœ¬ä¾ç„¶ä¸è¾±ä½¿å‘½çš„åœ¨åšè¿™äº›äº‹æƒ…ã€‚ä¸è¿‡ 2.0 ç‰ˆæœ¬ä¿®å¤äº†ä¸€äº›é•¿æœŸå½±å“å¼€å‘è€…çš„è®¾è®¡ï¼Œè¿˜åŠ å…¥äº†å‰æ‰€æœªæœ‰çš„å¼ºå¤§ç‰¹æ€§ã€‚åœ¨ NYC 2015 çš„è¿™ä¸€ä¸ªåˆ†äº«ä¸­ï¼Œ<a href="https://twitter.com/jakewharton" target="_blank" rel="noopener">Jake Wharton</a> çš„æ¼”è®²æ¶µç›–äº†æ‰€æœ‰ Retrofit 2.0 çš„æ–°ç‰¹æ€§ï¼Œå…¨é¢ä»‹ç»äº† Retrofit 2.0 å·¥ä½œåŸç†ã€‚</p>
<hr>
<hr>
<p><em>Save the date for Droidcon SF in March â€” a conference with best-in-class presentations from leaders in all parts of the Android ecosystem.</em></p>
<hr>
<h3 id="ç®€ä»‹-0-00"><a href="#ç®€ä»‹-0-00" class="headerlink" title="ç®€ä»‹ (0:00);)"></a>ç®€ä»‹ <a href="javascript:presentz.changeChapter(0,0,true" target="_blank" rel="noopener">(0:00)</a>;)</h3><p>æˆ‘å« <a href="https://twitter.com/jakewharton" target="_blank" rel="noopener">Jake Wharton</a>ï¼Œç°åœ¨åœ¨ <a href="https://squareup.com/" target="_blank" rel="noopener">Square</a> å·¥ä½œã€‚ä¸€ä¸ªå¤©çœŸçš„äººæ›¾ç»è¯´è¿‡ï¼šâ€Retrofit 2 å°†ä¼šåœ¨ä»Šå¹´å¹´åº•å‰æ”¾å‡ºã€‚â€ï¼Œé‚£ä¸ªäººï¼Œå°±æ˜¯å»å¹´åœ¨çº½çº¦ DroidCon ä¸Šè¡¨æ€çš„æˆ‘ã€‚ç„¶è€Œï¼Œäº‹å®æ˜¯ Retrofit 2 <strong>å°†ä¼šåœ¨ä»Šå¹´å¹´åº•æ”¾å‡º</strong>ï¼Œè¿™æ¬¡æˆ‘ä¿è¯ï¼</p>
<p><a href="http://square.github.io/retrofit/" target="_blank" rel="noopener">Retrofit</a> 5å¹´å‰å°±å¼€æºäº†ï¼Œæ˜¯ Square æœ€æ—©çš„å¼€æºé¡¹ç›®ä¹‹ä¸€ã€‚ä¸€å¼€å§‹çš„æ—¶å€™ï¼ŒRetrofit åªæ˜¯æˆ‘ä»¬ç”¨åœ¨å„ä¸ªå¼€æºé¡¹ç›®é‡Œçš„ç¦è¢‹ï¼šæ¯”å¦‚è¯´æœ€æ—©é‡Œé¢æœ‰æ™ƒåŠ¨æ£€æµ‹åŠŸèƒ½ï¼ŒHTTP Clientï¼Œè¿˜æœ‰ç°åœ¨çš„ tap åº“ã€‚å¤šæ•°åŠŸèƒ½éƒ½æ˜¯ Bob Lee å®Œæˆçš„ï¼Œæˆ‘å¤§æ¦‚ 3 å¹´å‰å¼€å§‹æ¥ç®¡è¿™äº›å·¥ä½œã€‚æœ€ç»ˆå†ç» 3 å¹´ï¼Œå®Œæˆäº† 1.0 ç‰ˆæœ¬ï¼Œç„¶åå½»åº•å¼€æºã€‚ä»é‚£ä¼šå„¿åˆ°ç°åœ¨ï¼Œå·²ç» release äº† 18 ä¸ªç‰ˆæœ¬äº†ã€‚</p>
<h3 id="Retrofit-1-ä¸é”™çš„åœ°æ–¹-2-23"><a href="#Retrofit-1-ä¸é”™çš„åœ°æ–¹-2-23" class="headerlink" title="Retrofit 1 ä¸é”™çš„åœ°æ–¹ (2:23);)"></a>Retrofit 1 ä¸é”™çš„åœ°æ–¹ <a href="javascript:presentz.changeChapter(0,11,true" target="_blank" rel="noopener">(2:23)</a>;)</h3><p>Retrofit é‡Œå·²ç»æœ‰å¾ˆå¤šä¸é”™çš„ç‰¹æ€§äº†ã€‚Retrofit å¯ä»¥åˆ©ç”¨æ¥å£ï¼Œæ–¹æ³•å’Œæ³¨è§£å‚æ•°ï¼ˆparameter annotationsï¼‰æ¥å£°æ˜å¼å®šä¹‰ä¸€ä¸ªè¯·æ±‚åº”è¯¥å¦‚ä½•è¢«åˆ›å»ºã€‚æ¯”å¦‚è¯´ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå¦‚ä½•è¯·æ±‚ GitHub API çš„ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  List&lt;Contributor&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Retrofit èƒŒåçš„ HTTP clientï¼Œä»¥åŠåºåˆ—åŒ–æœºåˆ¶ï¼ˆJSON/XML åè®®ï¼‰éƒ½æ˜¯å¯æ›¿æ¢ï¼ˆpluggableï¼‰çš„ï¼Œå› æ­¤ä½ å¯ä»¥é€‰æ‹©åˆé€‚è‡ªå·±çš„æ–¹æ¡ˆã€‚Retrofit æœ€æ—©å‡ºæ¥çš„æ—¶å€™ï¼Œåªæ”¯æŒ Apache çš„ HTTP clientã€‚åœ¨ 1.0 æ”¾å‡ºå‰ï¼Œæˆ‘ä»¬å¢åŠ äº† URL connectionï¼Œä»¥åŠ OkHttp çš„æ”¯æŒã€‚å¦‚æœä½ æƒ³è¦åŠ å…¥çš„å…¶ä»–çš„ HTTP clientï¼Œéƒ½å¯ä»¥ç®€å•çš„åŠ å…¥ã€‚è¿™ä¸ªç‰¹æ€§éå¸¸èµï¼Œè®©æˆ‘ä»¬æœ‰èƒ½åŠ›å»æ”¯æŒä¸åŒçš„è‡ªå®šä¹‰ clientã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">builder.setClient(new UrlConnectionClient());</span><br><span class="line">builder.setClient(new ApacheClient());</span><br><span class="line">builder.setClient(new OkClient());</span><br><span class="line"></span><br><span class="line">builder.setClient(new CustomClient());</span><br></pre></td></tr></table></figure>
<p>åºåˆ—åŒ–åŠŸèƒ½ä¹Ÿæ˜¯å¯æ›¿æ¢çš„ã€‚é»˜è®¤æ˜¯ç”¨çš„ GSONï¼Œä½ å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ Jackson æ¥æ›¿æ¢æ‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  List&lt;Contributor&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">builder.setConverter(new GsonConverter());</span><br><span class="line">builder.setConverter(new JacksonConverter());</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ åœ¨ç”¨æŸäº›æ•°æ®äº¤æ¢åè®®ï¼Œæ¯”å¦‚ protocol bufferï¼ŒRetrofit ä¹Ÿæ”¯æŒ Google çš„ <a href="https://github.com/google/protobuf">protobuf</a>ï¼Œä¹ŸåŒ…æ‹¬ XML åè®®çš„è½¬æ¢ï¼ˆå¦‚æœä½ è‡ªå·±ä¸æ€•æŠ˜è…¾ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  ContributorResponse repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">builder.setConverter(new ProtoConverter());</span><br><span class="line">builder.setConverter(new WireConverter());</span><br><span class="line"></span><br><span class="line">builder.setConverter(new SimpleXMLConverter());</span><br><span class="line"></span><br><span class="line">builder.setConverter(new CustomConverter());</span><br></pre></td></tr></table></figure>
<p>åºåˆ—åŒ–éƒ¨åˆ†è·Ÿ client éƒ¨åˆ†ä¸€æ ·ï¼Œéƒ½æ˜¯å¯æ›¿æ¢çš„ã€‚ä½ å¦‚æœæƒ³è¦å¼•å…¥æˆ–è€…å®ç°è‡ªå·±çš„åºåˆ—åŒ–ç»„ä»¶ï¼Œå®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚</p>
<p>åœ¨å‘è¯·æ±‚çš„å®ç°ä¸Šï¼Œä½ å¯ä»¥ç”¨çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼šåŒæ­¥å‘é€è¯·æ±‚â€”â€”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  List&lt;Contributor&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List&lt;Contributor&gt; contributors =</span><br><span class="line">    gitHubService.repoContributors(&quot;square&quot;, &quot;retrofit&quot;);</span><br></pre></td></tr></table></figure>
<p>â€”â€”å’Œå¼‚æ­¥å‘é€ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«å°±æ˜¯å¼‚æ­¥å‘é€è¦åœ¨æœ€åä¸€ä¸ªå‚æ•°ä¸Šå£°æ˜ä¸€ä¸ª callback å›è°ƒå‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  void repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo,</span><br><span class="line">      Callback&lt;List&lt;Contributor&gt;&gt; cb);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">service.repoContributors(&quot;square&quot;, &quot;retrofit&quot;, new Callback&lt;List&lt;Contributor&gt;&gt;() &#123;</span><br><span class="line">  @Override void success(List&lt;Contributor&gt; contributors, Response response) &#123;</span><br><span class="line">    // ...</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override void failure(RetrofitError error) &#123;</span><br><span class="line">    // ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>â€”â€”å†åˆ°åæ¥ 1.0 åï¼Œæˆ‘ä»¬è¿˜æ”¯æŒäº† <a href="https://github.com/ReactiveX/RxJava">RxJava</a> ï¼Œè¢«è¯æ˜çœŸçš„æ˜¯ä¸ªéå¸¸å—æ¬¢è¿çš„åŠŸèƒ½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Observable&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gitHubService.repoContributors(&quot;square&quot;, &quot;retrofit&quot;)</span><br><span class="line">    .subscribe(new Action1&lt;List&lt;Contributor&gt;&gt;() &#123;</span><br><span class="line">      @Override public void call(List&lt;Contributor&gt; contributors) &#123;</span><br><span class="line">        // ...</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Retrofit-1-ä¸å¤Ÿå¥½çš„åœ°æ–¹-4-58"><a href="#Retrofit-1-ä¸å¤Ÿå¥½çš„åœ°æ–¹-4-58" class="headerlink" title="Retrofit 1: ä¸å¤Ÿå¥½çš„åœ°æ–¹ (4:58);)"></a>Retrofit 1: ä¸å¤Ÿå¥½çš„åœ°æ–¹ <a href="javascript:presentz.changeChapter(0,28,true" target="_blank" rel="noopener">(4:58)</a>;)</h3><p>ä¸å¹¸çš„æ˜¯ï¼Œæ²¡æœ‰ä¸€ä¸ªåº“æ˜¯å®Œç¾çš„ï¼ŒRetrofit ä¹Ÿä¸ä¾‹å¤–ã€‚ä¸ºäº†æ”¯æŒå¯æ›¿æ¢çš„åŠŸèƒ½æ¨¡å—ï¼Œæˆ‘ä»¬å¿…é¡»åµŒå¥—å¤§é‡çš„ç»„ä»¶ï¼Œç±»çš„æ•°é‡æå¤šä»¥è‡³äºæˆä¸ºäº†ä¸€ä¸ªç—›å¤„ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºæ•´ä¸ªåº“éå¸¸çš„è„†å¼±ï¼Œè¿˜æœ‰å°±æ˜¯å› ä¸ºæˆ‘ä»¬æ— æ³•ä¿®æ”¹å…¬å¼€çš„ API æ¥å£ã€‚</p>
<p>Receive news and updates from Realm straight to your inbox</p>
<p>è®¢é˜…Comments</p>
<p>å¦‚æœä½ æƒ³è¦æ“ä½œæŸæ¬¡è¯·æ±‚è¿”å›çš„æ•°æ®ï¼Œæ¯”å¦‚è¯´è¿”å›çš„ Header éƒ¨åˆ†æˆ–è€… URLï¼Œä½ åˆåŒæ—¶æƒ³è¦æ“ä½œåºåˆ—åŒ–åçš„æ•°æ®éƒ¨åˆ†ï¼Œè¿™æ˜¯ Retrofit 1.0 ä¸Šæ˜¯ä¸å¯èƒ½å®ç°çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  List&lt;Contributor&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Response repoContributors2(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢çš„è¿™ä¸ª GitHub çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬è¿”å›äº†ä¸€ä¸ª contributor çš„åˆ—è¡¨ï¼Œä½ å¯ä»¥ç”¨ä¸åŒçš„ converter å»åšååºåˆ—åŒ–ã€‚ç„¶è€Œï¼Œå¦‚æœè¯´ä½ è¦è¯»å–ä¸€ä¸ª reponse çš„ header éƒ¨åˆ†ã€‚é™¤éä½ è®¾ç½®ä¸€ä¸ª endpoint æ¥æ¥ç®¡è¿™ä¸ª reponseï¼Œä¸ç„¶ä½ æ²¡æœ‰åŠæ³•å»è¯»å–è¿™ä¸ª responseã€‚ ç”±äº response header æ•°æ®é‡Œå¹¶æ²¡æœ‰ååºåˆ—åŒ–åçš„å¯¹è±¡ï¼Œå¦‚æœä¸åšååºåˆ—åŒ–æ“ä½œçš„è¯ï¼Œé‚£ä½ ä¹Ÿå°±æ— æ³•æ‹¿åˆ° contributor å¯¹è±¡äº†ã€‚</p>
<p>æˆ‘åˆšæ‰è¯´è¿‡åŒæ­¥å’Œå¼‚æ­¥ï¼Œä»¥åŠç”¨èµ·æ¥éå¸¸æ£’çš„ RxJavaï¼Œä½†æ˜¯è¿™äº›ç”¨èµ·æ¥å´æœ‰äº›åˆ»æ¿ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬åœ¨æŸäº›åœºæ™¯ä¸‹æ—¢éœ€è¦å¼‚æ­¥çš„è°ƒç”¨ï¼Œåˆéœ€è¦åŒæ­¥çš„è°ƒç”¨ã€‚åœ¨ Retrofit 1.0 é‡Œï¼Œä½ å¿…é¡»å¾—å£°æ˜ä¸¤æ¬¡è¿™ä¸ªæ–¹æ³•ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  List&lt;Contributor&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  void repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo,</span><br><span class="line">      Callback&lt;List&lt;Contributor&gt;&gt; cb);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>RxJava ä¹Ÿæœ‰ç±»ä¼¼é—®é¢˜ã€‚ä½†å€¼å¾—åº†å¹¸çš„æ˜¯ä½ åœ¨ç”¨ RxJava çš„æ—¶å€™åªç”¨å£°æ˜ä¸€æ¬¡å°±è¡Œï¼Œä¸ºäº†å®ç°è¿™ä¸ªï¼Œæˆ‘ä»¬è¿˜åœ¨æ ¸å¿ƒä»£ç é‡Œå¢åŠ äº†å¯¹ RxJava çš„æ”¯æŒï¼Œä»¥è¾…åŠ©è¿”å› Observable çš„å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Observable&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯èƒ½å·²ç»ç†Ÿæ‚‰å¦‚ä½•åœ¨ Retrofit é‡Œåˆ›å»º Observable å¯¹è±¡ã€‚ä½†æ˜¯å¦‚æœä½ éœ€è¦ä¸€äº›å…¶ä»–å¯¹è±¡å‘¢ï¼Ÿ æ¯”å¦‚ï¼Œæˆ‘ä»¬æ²¡æœ‰è®¡åˆ’æ”¯æŒç”¨äº† Guava çš„ ListenableFutureï¼Œä»¥åŠé‚£äº›ç”¨äº† Java 8 çš„ CompleteableFutureã€‚æ¯•ç«Ÿï¼ŒRetrofit 1 æ˜¯åŸºäºè¿˜åœ¨ç”¨ç€ Java 6 çš„ Android å¼€å‘çš„ã€‚</p>
<p>Retrofit 1 é‡Œ Converter å·¥ä½œçš„æ•ˆç‡å¹¶ä¸ç®—æ˜¯å¾ˆé«˜ã€‚ä¸‹é¢æ˜¯åœ¨ Retrofit 1 é‡Œåˆ›å»ºè‡ªå®šä¹‰ Converter çš„ä»£ç ï¼Œéå¸¸ç®€å•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">interface Converter &#123;</span><br><span class="line">  Object fromBody(TypedInput body, Type type);</span><br><span class="line">  TypedOutput toBody(Object object);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è‡ªå®šä¹‰ Converter æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–åçš„ HTTP å¯¹è±¡ã€‚é—®é¢˜æ˜¯åœ¨æˆ‘ä»¬ä¼ å…¥äº† Response å’Œä¸€ä¸ªæˆ‘ä»¬æƒ³è¦è½¬æ¢çš„æ ¼å¼ Type å‚æ•°åï¼ŒConverter å¿…é¡»å¾—ææ¸…æ¥šåˆ°åº•åº”è¯¥å¦‚ä½•å»ååºåˆ—åŒ–ï¼Œè¿™éƒ¨åˆ†çš„å®ç°å¾ˆå¤æ‚ï¼Œè€Œä¸”è€—æ—¶ã€‚å°½ç®¡ä¸€äº›åº“åšäº†å¯¹è±¡çš„ç¼“å­˜ï¼Œä½†ä¾ç„¶æ•ˆç‡å¾ˆä½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/search/repositories&quot;)</span><br><span class="line">  RepositoriesResponse searchRepos(</span><br><span class="line">      @Query(&quot;q&quot;) String query,</span><br><span class="line">      @Query(&quot;since&quot;) Date since);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/search/repositories?q=retrofit&amp;since=2015-08-27</span><br><span class="line">/search/repositories?q=retrofit&amp;since=20150827</span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶å€™ï¼Œå£°æ˜å¼ API ä¼šé‡åˆ°ä¸€äº›å°é—®é¢˜ã€‚æ¯”å¦‚å°±åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·ï¼Œä½ æœ‰ä¸ªæ¥å£éœ€è¦ä¼ å…¥ä¸€ä¸ª Dateï¼Œä½†æ˜¯ä¸€ä¸ª Date ä¼šæœ‰å¤šç§ä¸åŒçš„æ ¼å¼è¡¨ç¤ºã€‚æœ‰çš„æ¥å£å¯èƒ½éœ€è¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæœ‰çš„å¯èƒ½éœ€è¦ä¸€ä¸ªåˆ†éš”å¼€çš„æ—¥æœŸè¡¨ç¤ºï¼ˆå°¤å…¶æ˜¯é‚£äº›æ¯”æ—¥æœŸè¦å¤æ‚å¾ˆå¤šçš„å¯¹è±¡ï¼Œå¯èƒ½ä¼šæœ‰æ›´å¤šçš„è¡¨ç¤ºæ–¹æ³•ï¼‰ã€‚</p>
<p>ä»¥ä¸Šï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ Retrofit 1 æ— åŠ›è§£å†³çš„éœ€æ±‚äº†ï¼Œæˆ‘ä»¬è¦å¦‚ä½•ä¿®å¤å‘¢ï¼Ÿ</p>
<h3 id="Retrofit-2-10-18"><a href="#Retrofit-2-10-18" class="headerlink" title="Retrofit 2 (10:18);)"></a>Retrofit 2 <a href="javascript:presentz.changeChapter(0,48,true" target="_blank" rel="noopener">(10:18)</a>;)</h3><p>å¼€å‘ Retrofit2 çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬å®šä½å’Œè§£å†³æ‰€æœ‰å¤§å®¶å¤šå¹´ä»¥æ¥åœ¨ Retrofit 1 é‡Œé‡åˆ°çš„é‚£äº›é—®é¢˜ã€‚</p>
<h4 id="Call-10-30"><a href="#Call-10-30" class="headerlink" title="Call (10:30);)"></a>Call <a href="javascript:presentz.changeChapter(0,49,true" target="_blank" rel="noopener">(10:30)</a>;)</h4><p>é¦–å…ˆå¾—æåˆ°çš„æ˜¯ï¼šRetrofit2 æœ‰äº†æ–°çš„ç±»å‹ã€‚å¦‚æœä½ ç†Ÿæ‚‰ç”¨ OkHttp åš API è¯·æ±‚ï¼Œä½ å¯èƒ½æ¯”è¾ƒç†Ÿæ‚‰å…¶ä¸­çš„ä¸€ä¸ªç±»ï¼š<code>Call</code>ã€‚ç°åœ¨ï¼Œ Retrofit 2 é‡Œä¹Ÿå¤šäº†ä¸€ä¸ª <code>call</code> æ–¹æ³•ã€‚è¯­æ³•å’Œ OkHttp åŸºæœ¬ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒæ˜¯è¿™ä¸ªå‡½æ•°çŸ¥é“å¦‚ä½•åšæ•°æ®çš„ååºåˆ—åŒ–ã€‚å®ƒçŸ¥é“å¦‚ä½•å°† HTTP å“åº”è½¬æ¢æˆå¯¹è±¡ã€‚</p>
<p>å¦å¤–ï¼Œæ¯ä¸€ä¸ª call å¯¹è±¡å®ä¾‹åªèƒ½è¢«ç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥è¯´ request å’Œ response éƒ½æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ä½ å…¶å®å¯ä»¥é€šè¿‡ <code>Clone</code> æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å®ä¾‹ï¼Œè¿™ä¸ªå¼€é”€æ˜¯å¾ˆå°çš„ã€‚æ¯”å¦‚è¯´ï¼šä½ å¯ä»¥åœ¨æ¯æ¬¡å†³å®šå‘è¯·æ±‚å‰ <code>clone</code> ä¸€ä¸ªä¹‹å‰çš„å®ä¾‹ã€‚</p>
<p>å¦ä¸€ä¸ªå¤§çš„è¿›æ­¥æ˜¯ 2.0 åŒæ—¶æ”¯æŒäº†åœ¨ä¸€ä¸ªç±»å‹ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥ã€‚åŒæ—¶ï¼Œä¸€ä¸ªè¯·æ±‚ä¹Ÿå¯ä»¥è¢«<strong>çœŸæ­£åœ°</strong>ç»ˆæ­¢ã€‚ç»ˆæ­¢æ“ä½œä¼šå¯¹åº•å±‚çš„ http client æ‰§è¡Œ cancel æ“ä½œã€‚å³ä¾¿æ˜¯æ­£åœ¨æ‰§è¡Œçš„è¯·æ±‚ï¼Œä¹Ÿèƒ½ç«‹å³åˆ‡æ–­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Call&lt;List&lt;Contributor&gt;&gt; call =</span><br><span class="line">    gitHubService.repoContributors(&quot;square&quot;, &quot;retrofit&quot;);</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª Call å¯¹è±¡æ˜¯ä»ä½ çš„ API æ¥å£è¿”å›çš„å‚æ•°åŒ–åçš„å¯¹è±¡ã€‚è°ƒç”¨è·Ÿæ¥å£åç›¸åŒçš„å‡½æ•°åï¼Œä½ å°±ä¼šå¾—åˆ°ä¸€ä¸ªå®ä¾‹å‡ºæ¥ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨å®ƒçš„ execute æ–¹æ³•ï¼Œä½†æ˜¯å¾—ç•™æ„ä¸€ä¸‹ï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½è°ƒç”¨ä¸€æ¬¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Call&lt;List&lt;Contributor&gt;&gt; call =</span><br><span class="line">    gitHubService.repoContributors(&quot;square&quot;, &quot;retrofit&quot;);</span><br><span class="line"></span><br><span class="line">response = call.execute();</span><br><span class="line"></span><br><span class="line">// This will throw IllegalStateException:</span><br><span class="line">response = call.execute();</span><br><span class="line"></span><br><span class="line">Call&lt;List&lt;Contributor&gt;&gt; call2 = call.clone();</span><br><span class="line">// This will not throw:</span><br><span class="line">response = call2.execute();</span><br></pre></td></tr></table></figure>
<p>å½“ä½ å°è¯•è°ƒç”¨ç¬¬äºŒæ¬¡çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°å¤±è´¥çš„é”™è¯¯ã€‚å®é™…ä¸Šï¼Œå¯ä»¥ç›´æ¥å…‹éš†ä¸€ä¸ªå®ä¾‹ï¼Œä»£ä»·éå¸¸ä½ã€‚å½“ä½ æƒ³è¦å¤šæ¬¡è¯·æ±‚ä¸€ä¸ªæ¥å£çš„æ—¶å€™ï¼Œç›´æ¥ç”¨ clone çš„æ–¹æ³•æ¥ç”Ÿäº§ä¸€ä¸ªæ–°çš„ï¼Œç›¸åŒçš„å¯ç”¨å¯¹è±¡å§ã€‚</p>
<p>æƒ³è¦å®ç°å¼‚æ­¥ï¼Œéœ€è¦è°ƒç”¨ <code>enqueue</code> æ–¹æ³•ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡ä¸€æ¬¡å£°æ˜å®ç°åŒæ­¥å’Œå¼‚æ­¥äº†ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Call&lt;List&lt;Contributor&gt;&gt; call =</span><br><span class="line">    gitHubService.repoContributors(&quot;square&quot;, &quot;retrofit&quot;);</span><br><span class="line"></span><br><span class="line">call.enqueue(new Callback&lt;List&lt;Contributor&gt;&gt;() &#123;</span><br><span class="line">  @Override void onResponse(/* ... */) &#123;</span><br><span class="line">    // ...</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override void onFailure(Throwable t) &#123;</span><br><span class="line">    // ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å½“ä½ å°†ä¸€äº›å¼‚æ­¥è¯·æ±‚å‹å…¥é˜Ÿåˆ—åï¼Œç”šè‡³ä½ åœ¨æ‰§è¡ŒåŒæ­¥è¯·æ±‚çš„æ—¶å€™ï¼Œä½ å¯ä»¥éšæ—¶è°ƒç”¨ <code>cancel</code> æ–¹æ³•æ¥å–æ¶ˆè¯·æ±‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Call&lt;List&lt;Contributor&gt;&gt; call =</span><br><span class="line">    gitHubService.repoContributors(&quot;square&quot;, &quot;retrofit&quot;);</span><br><span class="line"></span><br><span class="line">call.enqueue(         );</span><br><span class="line">// or...</span><br><span class="line">call.execute();</span><br><span class="line"></span><br><span class="line">// later...</span><br><span class="line">call.cancel();</span><br></pre></td></tr></table></figure>
<h4 id="Parameterized-Response-Object-13-48"><a href="#Parameterized-Response-Object-13-48" class="headerlink" title="Parameterized Response Object (13:48);)"></a>Parameterized Response Object <a href="javascript:presentz.changeChapter(0,68,true" target="_blank" rel="noopener">(13:48)</a>;)</h4><p>å¦ä¸€ä¸ªæ–°çš„ç‰¹æ€§æ˜¯å‚æ•°åŒ–çš„ Response ç±»å‹ã€‚ Response å¯¹è±¡å¢åŠ äº†æ›¾ç»ä¸€ç›´è¢«æˆ‘ä»¬å¿½ç•¥æ‰çš„é‡è¦å…ƒæ•°æ®ï¼šå“åº”ç ï¼ˆthe reponse codeï¼‰ï¼Œå“åº”æ¶ˆæ¯ï¼ˆthe response messageï¼‰ï¼Œä»¥åŠè¯»å–ç›¸åº”å¤´ï¼ˆheadersï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class Response&lt;T&gt; &#123;</span><br><span class="line">  int code();</span><br><span class="line">  String message();</span><br><span class="line">  Headers headers();</span><br><span class="line"></span><br><span class="line">  boolean isSuccess();</span><br><span class="line">  T body();</span><br><span class="line">  ResponseBody errorBody();</span><br><span class="line">  com.squareup.okhttp.Response raw();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶è¿˜æä¾›äº†ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„å‡½æ•°æ¥å¸®åŠ©ä½ åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸå®Œæˆï¼Œå…¶å®å°±æ˜¯æ£€æŸ¥äº†ä¸‹å“åº”ç æ˜¯ä¸æ˜¯ 200ã€‚ç„¶åå°±æ‹¿åˆ°äº†å“åº”çš„ body éƒ¨åˆ†ï¼Œå¦å¤–æœ‰ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•è·å– error bodyã€‚åŸºæœ¬ä¸Šå°±æ˜¯å‡ºç°ä¸€ä¸ªè¿”å›ç ï¼Œç„¶åè°ƒç”¨ç›¸å¯¹åº”çš„å‡½æ•°çš„ã€‚åªæœ‰å½“å“åº”æˆåŠŸä»¥åï¼Œæˆ‘ä»¬ä¼šå»åšååºåˆ—åŒ–æ“ä½œï¼Œç„¶åå°†ååºåˆ—åŒ–çš„ç»“æœæ”¾åˆ° body å›è°ƒä¸­å»ã€‚å¦‚æœå‡ºç°äº†è¿”å›äº†ç½‘ç»œæˆåŠŸå“åº”ï¼ˆè¿”å›ç ï¼š200ï¼‰å´æœ€ç»ˆè¿”å› false çš„æƒ…å†µï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯æ— æ³•åˆ¤æ–­è¿”å›åˆ°åº•æ˜¯ä»€ä¹ˆçš„ï¼Œåªèƒ½å°† <code>ResponseBody</code>ï¼ˆç®€å•å°è£…çš„äº† content-typeï¼Œlengthï¼Œä»¥åŠ raw bodyéƒ¨åˆ†ï¼‰ ç±»å‹äº¤ç»™ä½ å»å¤„ç†ã€‚</p>
<p>ä»¥ä¸Šæ˜¯åœ¨å£°æ˜æ¥å£æ—¶å€™çš„ä¸¤ä¸ªé‡å¤§çš„æ”¹å˜ã€‚</p>
<h4 id="åŠ¨æ€-URL-Parameter-16-33"><a href="#åŠ¨æ€-URL-Parameter-16-33" class="headerlink" title="åŠ¨æ€ URL Parameter (16:33);)"></a>åŠ¨æ€ URL Parameter <a href="javascript:presentz.changeChapter(0,101,true" target="_blank" rel="noopener">(16:33)</a>;)</h4><p>åŠ¨æ€ URL å‚æ•°æ˜¯è®©æˆ‘å¤´ç–¼å¤šå¹´çš„ä¸€ä¸ªé—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬ç»ˆäºè§£å†³äº†ï¼å¦‚æœä½ å‘ GitHub å‘å‡ºå¤šä¸ªè¯·æ±‚ï¼Œæ”¶åˆ°ä¸€ä¸ªå“åº”ï¼Œé€šå¸¸è¿™ä¸ªå“åº”å¤§æ¦‚åƒä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Call&lt;List&lt;Contributor&gt;&gt; call =</span><br><span class="line">    gitHubService.repoContributors(&quot;square&quot;, &quot;retrofit&quot;);</span><br><span class="line">Response&lt;List&lt;Contributor&gt;&gt; response = call.execute();</span><br><span class="line"></span><br><span class="line">// HTTP/1.1 200 OK</span><br><span class="line">// Link: &lt;https://api.github.com/repositories/892275/contributors?</span><br><span class="line">page=2&gt;; rel=&quot;next&quot;, &lt;https://api.github.com/repositories/892275/</span><br><span class="line">contributors?page=3&gt;; rel=&quot;last&quot;</span><br><span class="line">// ...</span><br></pre></td></tr></table></figure>
<p>è¦æ˜¯ä½ æƒ³åšåˆ†é¡µï¼Œä½ å°±å¾—è‡ªå·±å»åˆ†æè¿™äº› URL äº†ã€‚GitHub å¯èƒ½å°† header link åœ°å€åˆ—è¡¨é‡Œçš„æ•°æ®å·²ç»ç¼“å­˜åœ¨æœåŠ¡å™¨å†…å­˜é‡Œäº†ï¼Œå½“ä½ å»æŒ‰ä»–ä»¬æŒ‡å¼•çš„åœ°å€å»è¯·æ±‚çš„è¯ï¼Œä»–ä»¬å°±ä¸å¿…è´¹åŠ²å»ä»æ•°æ®åº“é‡Œç»™ä½ æ‹¿æ•°æ®äº†ï¼Œé€Ÿåº¦ä¸Šä¹Ÿæ›´å¿«ã€‚ä½†æ˜¯ï¼Œåœ¨ Retrofit 1.0 çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•å»ç›´æ¥æ‰§è¡Œ GitHub Server è¿”å›åœ¨ header é‡Œçš„è¯·æ±‚åœ°å€ã€‚</p>
<p>ç”¨ä¸Šæˆ‘ä»¬æ–°çš„ response ç±»å‹åï¼Œä¸æ­¢æ˜¯æˆ‘åˆšæ‰æåˆ°çš„é‚£äº›å…ƒæ•°æ®ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å†™ä¸€äº›æ–¹æ³•æ¥è¯»å‡ºè‡ªå®šä¹‰çš„å­—æ®µï¼Œæ¯”å¦‚ä¸Šé¢ä¾‹å­é‡Œçš„ä¸‹ä¸€é¡µçš„åœ°å€ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Response&lt;List&lt;Contributor&gt;&gt; response = call.execute();</span><br><span class="line"></span><br><span class="line">// HTTP/1.1 200 OK</span><br><span class="line">// Link: &lt;https://api.github.com/repositories/892275/contributors?</span><br><span class="line">page=2&gt;; rel=&quot;next&quot;, &lt;https://api.github.com/repositories/892275/</span><br><span class="line">contributors?page=3&gt;; rel=&quot;last&quot;</span><br><span class="line">// ...</span><br><span class="line"></span><br><span class="line">String links = response.headers().get(&quot;Link&quot;);</span><br><span class="line">String nextLink = nextFromGitHubLinks(links);</span><br><span class="line"></span><br><span class="line">// https://api.github.com/repositories/892275/contributors?page=2</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå¯èƒ½å’Œä¸Šé¢çš„æ¥å£ç”Ÿæˆåœ°å€ç•¥æœ‰ä¸åŒã€‚</p>
<p>åŠ¨æ€ URL åœ°å€å°±æ˜¯ç”¨åœ¨è¿ç»­è¯·æ±‚é‡Œçš„ã€‚åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ä¹‹åï¼Œå¦‚æœè¿”å›çš„ç»“æœé‡Œæœ‰æŒ‡æ˜ä¸‹ä¸ªè¯·æ±‚çš„åœ°å€çš„è¯ï¼Œåœ¨ä¹‹å‰ï¼Œä½ å¯èƒ½å¾—å•ç‹¬å†™ä¸ª interface æ¥å¤„ç†è¿™ç§æƒ…å†µï¼Œç°åœ¨å°±æ— éœ€é‚£ä¹ˆè´¹äº‹äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line"></span><br><span class="line">  @GET</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributorsPaginate(</span><br><span class="line">      @Url String url);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Retrofit 2.0 æœ‰äº†æ–°çš„ æ ‡æ³¨ï¼š<code>@Url</code> ï¼Œå…è®¸ä½ ç›´æ¥ä¼ å…¥ä¸€ä¸ªè¯·æ±‚çš„ URLã€‚</p>
<p>æœ‰äº†è¿™ä¸ªæ–¹æ³•åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æŠŠåˆšæ‰å–å‡ºæ¥çš„ä¸‹ä¸€é¡µçš„åœ°å€ä¼ å…¥ï¼Œæ˜¯ä¸æ˜¯ä¸€åˆ‡éƒ½æµç•…äº†å¾ˆå¤šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String nextLink = nextFromGitHubLinks(links);</span><br><span class="line"></span><br><span class="line">// https://api.github.com/repositories/892275/contributors?page=2</span><br><span class="line"></span><br><span class="line">Call&lt;List&lt;Contributor&gt;&gt; nextCall =</span><br><span class="line">    gitHubService.repoContributorsPaginate(nextLink);</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡è°ƒç”¨ <code>repoContributorsPaginate</code> æ¥è·å–ç¬¬äºŒé¡µå†…å®¹ï¼Œç„¶åé€šè¿‡ç¬¬äºŒé¡µçš„ header æ¥è¯·æ±‚ç¬¬ä¸‰é¡µã€‚ä½ å¯èƒ½å¾ˆå¤šçš„ API éƒ½è§åˆ°è¿‡ç±»ä¼¼çš„è®¾è®¡ï¼Œè¿™åœ¨ Retrofit 1 é‡Œç¡®å®æ˜¯ä¸ªå›°æ‰°å¾ˆå¤šäººçš„å¤§éº»çƒ¦ã€‚</p>
<h4 id="æ›´å¤šæ›´æœ‰æ•ˆçš„-Converters-19-31"><a href="#æ›´å¤šæ›´æœ‰æ•ˆçš„-Converters-19-31" class="headerlink" title="æ›´å¤šæ›´æœ‰æ•ˆçš„ Converters (19:31);)"></a>æ›´å¤šæ›´æœ‰æ•ˆçš„ Converters <a href="javascript:presentz.changeChapter(0,113,true" target="_blank" rel="noopener">(19:31)</a>;)</h4><p>Retrofit 1 é‡Œæœ‰ä¸€ä¸ª converter çš„é—®é¢˜ã€‚å¤šæ•°äººå¯èƒ½æ²¡é‡åˆ°è¿‡ï¼Œæ˜¯åº“å†…éƒ¨çš„ä¸€ä¸ªé—®é¢˜ã€‚åœ¨ Retrofit 2 é‡Œï¼Œæˆ‘ä»¬å·²ç»è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼ŒåŒæ—¶å¼€å§‹æ”¯æŒå¤šç§ Converter å¹¶å­˜ã€‚</p>
<p>åœ¨ä¹‹å‰ï¼Œå¦‚æœä½ é‡åˆ°è¿™ç§æƒ…å†µï¼šä¸€ä¸ª API è¯·æ±‚è¿”å›çš„ç»“æœéœ€è¦é€šè¿‡ JSON ååºåˆ—åŒ–ï¼Œå¦ä¸€ä¸ª API è¯·æ±‚éœ€è¦é€šè¿‡ proto ååºåˆ—åŒ–ï¼Œå”¯ä¸€çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯å°†ä¸¤ä¸ªæ¥å£åˆ†ç¦»å¼€å£°æ˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface SomeProtoService &#123;</span><br><span class="line">  @GET(&quot;/some/proto/endpoint&quot;)</span><br><span class="line">  Call&lt;SomeProtoResponse&gt; someProtoEndpoint();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface SomeJsonService &#123;</span><br><span class="line">  @GET(&quot;/some/json/endpoint&quot;)</span><br><span class="line">  Call&lt;SomeJsonResponse&gt; someJsonEndpoint();</span><br></pre></td></tr></table></figure>
<p>ä¹‹æ‰€ä»¥æå¾—è¿™ä¹ˆéº»çƒ¦æ˜¯å› ä¸ºä¸€ä¸ª REST adapter åªèƒ½ç»‘å®šä¸€ä¸ª Converter å¯¹è±¡ã€‚æˆ‘ä»¬è´¹å·¥å¤«å»è§£å†³è¿™ä¸ªæ˜¯å› ä¸ºï¼šæ¥å£çš„å£°æ˜æ˜¯è¦è¯­æ„åŒ–çš„ã€‚API æ¥å£åº”è¯¥é€šè¿‡åŠŸèƒ½å®ç°åˆ†ç»„ï¼Œæ¯”å¦‚ï¼š account çš„æ¥å£ï¼Œuser çš„æ¥å£ï¼Œæˆ–è€… Twitter ç›¸å…³çš„æ¥å£ã€‚è¿”å›æ ¼å¼çš„å·®å¼‚ä¸åº”è¯¥æˆä¸ºä½ åˆ†ç»„æ—¶å€™çš„é˜»ç¢ã€‚</p>
<p>ç°åœ¨ï¼Œä½ å¯ä»¥æŠŠä»–ä»¬éƒ½æ”¾åœ¨ä¸€èµ·äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface SomeService &#123;</span><br><span class="line">  @GET(&quot;/some/proto/endpoint&quot;)</span><br><span class="line">  Call&lt;SomeProtoResponse&gt; someProtoEndpoint();</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/some/json/endpoint&quot;)</span><br><span class="line">  Call&lt;SomeJsonResponse&gt; someJsonEndpoint();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘å¤§æ¦‚æä¸€ä¸‹è¿™ä¸ªæ˜¯æ€ä¹ˆå·¥ä½œèµ·æ¥çš„ï¼Œå› ä¸ºäº†è§£ Converter çš„è°ƒç”¨åŸç†åœ¨å†™ä»£ç çš„æ—¶å€™å¾ˆé‡è¦ã€‚</p>
<p>çœ‹æˆ‘ä»¬ä¸Šé¢çš„ä»£ç ï¼šç¬¬ä¸€ä¸ªæ–¹æ³•è¿”å›äº†ä¸€ä¸ª proto å¯¹è±¡ã€‚</p>
<p><code>SomeProtoResponse</code> â€”&gt; Proto? <strong>Yes!</strong></p>
<p>åŸç†å¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯å¯¹ç€æ¯ä¸€ä¸ª converter è¯¢é—®ä»–ä»¬æ˜¯å¦èƒ½å¤Ÿå¤„ç†æŸç§ç±»å‹ã€‚æˆ‘ä»¬é—® proto çš„ converterï¼š â€œHi, ä½ èƒ½å¤„ç† <code>SomeProtoResponse</code> å—ï¼Ÿâ€ï¼Œç„¶åå®ƒå°½å¯èƒ½çš„å»åˆ¤æ–­å®ƒæ˜¯å¦å¯ä»¥å¤„ç†è¿™ç§ç±»å‹ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼šProtobuff éƒ½æ˜¯ä»ä¸€ä¸ªåå« message æˆ–è€… message lite çš„ç±»ç»§æ‰¿è€Œæ¥ã€‚æ‰€ä»¥ï¼Œåˆ¤æ–­æ–¹æ³•é€šå¸¸å°±æ˜¯æ£€æŸ¥è¿™ä¸ªç±»æ˜¯å¦ç»§æ‰¿è‡ª messageã€‚</p>
<p>åœ¨é¢å¯¹ JSON ç±»å‹çš„æ—¶å€™ï¼Œé¦–å…ˆé—® proto converterï¼Œproto converter ä¼šå‘ç°è¿™ä¸ªä¸æ˜¯ç»§æ‰¿å­ Message çš„ï¼Œç„¶åå›å¤ noã€‚ç´§æ¥ç€ç§»åˆ°ä¸‹ä¸€ä¸ª JSON converter ä¸Šã€‚JSON Converter ä¼šå›å¤è¯´æˆ‘å¯ä»¥ï¼</p>
<p><code>SomeJsonResponse</code> â€”&gt; Proto? <strong>No!</strong> â€”&gt; JSON? <strong>Yes!</strong></p>
<p>å› ä¸º JSON å¹¶æ²¡æœ‰ä»€ä¹ˆç»§æ‰¿ä¸Šçš„çº¦æŸã€‚æ‰€ä»¥æˆ‘ä»¬æ— æ³•é€šè¿‡ä»€ä¹ˆç¡®åˆ‡çš„æ¡ä»¶æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ JSON å¯¹è±¡ã€‚ä»¥è‡³äº JSON çš„ converters ä¼šå¯¹ä»»ä½•æ•°æ®éƒ½å›å¤è¯´ï¼šæˆ‘å¯ä»¥å¤„ç†ï¼è¿™ä¸ªä¸€å®šè¦è®°ä½ï¼Œ JSON converter ä¸€å®šè¦æ”¾åœ¨æœ€åï¼Œä¸ç„¶ä¼šå’Œä½ çš„é¢„æœŸä¸ç¬¦ã€‚</p>
<p>å¦ä¸€ä¸ªè¦æ³¨æ„çš„æ˜¯ï¼Œç°åœ¨å·²ç»ä¸æä¾›é»˜è®¤çš„ converter äº†ã€‚å¦‚æœä¸æ˜¾æ€§çš„å£°æ˜ä¸€ä¸ªå¯ç”¨çš„ Converter çš„è¯ï¼ŒRetrofit æ˜¯ä¼šæŠ¥é”™çš„ï¼šæé†’ä½ æ²¡æœ‰å¯ç”¨çš„ Converterã€‚å› ä¸ºæ ¸å¿ƒä»£ç å·²ç»ä¸ä¾èµ–åºåˆ—åŒ–ç›¸å…³çš„ç¬¬ä¸‰æ–¹åº“äº†ï¼Œæˆ‘ä»¬ä¾ç„¶æä¾›å¯¹ Converter çš„æ”¯æŒï¼Œä¸è¿‡ä½ éœ€è¦è‡ªå·±å¼•å…¥è¿™äº›ä¾èµ–ï¼ŒåŒæ—¶æ˜¾æ€§çš„å£°æ˜ Retrofit éœ€è¦ç”¨çš„ Converter æœ‰å“ªäº›ã€‚</p>
<h4 id="æ›´å¤šå¯æ›¿æ¢çš„æ‰§è¡Œæœºåˆ¶-22-38"><a href="#æ›´å¤šå¯æ›¿æ¢çš„æ‰§è¡Œæœºåˆ¶-22-38" class="headerlink" title="æ›´å¤šå¯æ›¿æ¢çš„æ‰§è¡Œæœºåˆ¶ (22:38);)"></a>æ›´å¤šå¯æ›¿æ¢çš„æ‰§è¡Œæœºåˆ¶ <a href="javascript:presentz.changeChapter(0,121,true" target="_blank" rel="noopener">(22:38)</a>;)</h4><p>åœ¨æ­¤ä¹‹å‰ï¼ŒRetrofit æœ‰ä¸€ä¸ªæ­»æ¿çš„ execution æµç¨‹ã€‚åœ¨ Retrofit 2 é‡Œï¼Œæˆ‘ä»¬è°ƒæ•´äº†æ•´ä¸ªæµç¨‹ï¼Œè®©å®ƒå˜å¾—å¯æ›¿æ¢ï¼ˆpluggableï¼‰ï¼ŒåŒæ—¶å…è®¸å¤šä¸ªã€‚è·Ÿ converter çš„å·¥ä½œåŸç†å¾ˆåƒã€‚</p>
<p>æ¯”å¦‚è¯´ï¼Œä½ æœ‰ä¸€ä¸ªæ–¹æ³•è¿”å›äº†ä¸€ä¸ª Call å¯¹è±¡ï¼ŒCall æ˜¯å†…ç½®çš„ Converter ç±»å‹ã€‚æ¯”å¦‚ï¼šRetrofit 2ã€€çš„æ‰§è¡Œæœºåˆ¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰è¿™äº›äº†ã€‚æˆ–è€…ç”¨æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Observable&lt;List&lt;Contributor&gt;&gt; repoContributors2(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Future&lt;List&lt;Contributor&gt;&gt; repoContributors3(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Retrofit 2.0 ä¾ç„¶æ”¯æŒ RxJavaï¼Œä½†ç°åœ¨æ˜¯åˆ†ç¦»çš„ã€‚ï¼ˆä½ å¦‚æœæƒ³è¦ä¸€äº›åˆ«çš„ç‰¹æ€§ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªï¼‰åŒæ—¶æ”¯æŒä¸åŒçš„ execution æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(..);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Observable&lt;List&lt;Contributor&gt;&gt; repoContributors2(..);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Future&lt;List&lt;Contributor&gt;&gt; repoContributors3(..);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è¿”å›ç±»å‹æ¥åˆ¤æ–­éœ€è¦è°ƒç”¨å“ªä¸ª exectionã€‚æ¯”å¦‚è¯´ï¼šè¿”å›ä¸º Call çš„ç±»å‹ï¼Œ æˆ‘ä»¬çš„æ•´ä¸ªæ‰§è¡Œæœºåˆ¶ä¼šé—®ï¼šâ€œHeyï¼Œä½ çŸ¥ä¸çŸ¥é“å¦‚ä½•å¤„ç† Call ï¼Ÿâ€ã€€å¦‚æœæ˜¯ RxJavaï¼Œå®ƒå°±ä¼šè¯´ï¼šâ€œæˆ‘ä¸çŸ¥é“ï¼Œæˆ‘åªçŸ¥é“ã€€Observable çš„å¤„ç†æ–¹æ³•ã€‚â€ã€‚ã€€éšåï¼Œæˆ‘ä»¬åˆé—®å†…éƒ¨çš„ converterï¼Œä»–åˆšå¥½å›ç­”è¯´ï¼šâ€œæ˜¯çš„ï¼æˆ‘ä¼šï¼â€ã€‚</p>
<p><code>call</code> â€”&gt; RxJava? <strong>No!</strong> â€”&gt; Call? <strong>Yes!</strong></p>
<p>Observable ä¹Ÿæ˜¯åŒæ ·çš„å·¥ä½œåŸç†ã€‚æˆ‘ä»¬åŒæ ·é—® RxJavaï¼Œå®ƒå°±è¯´ï¼šâ€œæˆ‘èƒ½å¤„ç†è¿™ä¸ªâ€ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(..);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Observable&lt;List&lt;Contributor&gt;&gt; repoContributors2(..);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Future&lt;List&lt;Contributor&gt;&gt; repoContributors3(..);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Observable â€”&gt; RxJava? <strong>Yes!</strong></p>
<p>å¦‚æœä½ æ²¡è£…ç›¸å¯¹åº”çš„ Converterï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬æ— æ³•éªŒè¯å“åº”çš„ç±»å‹ã€‚æ¯”å¦‚ï¼šå¦‚æœè¯¢é—®æ˜¯å¦æœ‰åŠæ³•èƒ½å¤„ç†ã€€Futureï¼Œä»–ä»¬ä¸¤ä¸ªéƒ½ä¼šè¯´ï¼šâ€œä¸è¡Œâ€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(..);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Observable&lt;List&lt;Contributor&gt;&gt; repoContributors2(..);</span><br><span class="line"></span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Future&lt;List&lt;Contributor&gt;&gt; repoContributors3(..);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Future â€”&gt; RxJava? <strong>No!</strong> â€”&gt; Call? <strong>No!</strong> â€”&gt; Throw!</p>
<p>è¿™å°†ä¼šè¿”å›ä¸€ä¸ª Exceptionï¼Œæ„å‘³ç€è¿™ä¸¤ä¸ªä»¥åŠå†…ç½®çš„æœºåˆ¶éƒ½æ— æ³•å¤„ç†è¿™ç§ç±»å‹ã€‚å…³äºå·¥ä½œåŸç†æˆ‘ä»¬éšåä¼šæ·±å…¥è®¨è®ºã€‚</p>
<h3 id="OkHttp-æä¾›æ”¯æŒ-24-17"><a href="#OkHttp-æä¾›æ”¯æŒ-24-17" class="headerlink" title="OkHttp æä¾›æ”¯æŒ (24:17);)."></a>OkHttp æä¾›æ”¯æŒ <a href="javascript:presentz.changeChapter(0,135,true" target="_blank" rel="noopener">(24:17)</a>;).</h3><p>Retrofit 2 ç°åœ¨å¼€å§‹ä¾èµ–äº† OkHttp äº†ï¼Œè€Œä¸”è¿™éƒ¨åˆ†ä¸å†æ”¯æŒæ›¿æ¢ã€‚è¿™æ˜¯ä¸€ä»¶æ¯”è¾ƒæœ‰äº‰è®®çš„äº‹æƒ…ã€‚ä½†æ˜¯å¸Œæœ›æˆ‘èƒ½è¯æ˜ä¸ºä»€ä¹ˆè¿™æ˜¯ä¸€ä¸ªå¯¹çš„å†³å®šã€‚</p>
<p>OkHttp ç°åœ¨å¾ˆå°è€Œä¸”å¾ˆèšç„¦ï¼Œæœ‰å¾ˆå¤šå¥½ç”¨çš„ API æ¥å£ã€‚æˆ‘ä»¬åœ¨ Retrofit 2 é‡Œéƒ½æœ‰å¯¹ OkHttp çš„æ¥å£æ˜ å°„ï¼Œä¹ŸåŸºæœ¬å…·å¤‡äº†æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰çš„ç‰¹æ€§ï¼ŒåŒ…æ‹¬æåˆ°çš„æ‰€æœ‰çš„æŠ½è±¡ç±»ä»¬ã€‚è¿™äº›éƒ½è¶…èµï¼è¿™æ˜¯å‹ç¼© Retrofit åº“å¤§å°çš„ä¸€ä¸ªæ³•å®ã€‚æˆ‘ä»¬æœ€ç»ˆå‡å°äº†Retrofit 60% çš„ä½“ç§¯ï¼ŒåŒæ—¶åˆå…·æœ‰äº†æ›´å¤šçš„ç‰¹æ€§ã€‚</p>
<h3 id="OkHttp-æä¾›æ”¯æŒ-ä»¥åŠ-Okio-26-20"><a href="#OkHttp-æä¾›æ”¯æŒ-ä»¥åŠ-Okio-26-20" class="headerlink" title="OkHttp æä¾›æ”¯æŒ (ä»¥åŠ Okio!) (26:20);)"></a>OkHttp æä¾›æ”¯æŒ (ä»¥åŠ Okio!) <a href="javascript:presentz.changeChapter(0,141,true" target="_blank" rel="noopener">(26:20)</a>;)</h3><p>å¦ä¸€ä¸ªç”¨ OkHttp çš„å¥½å¤„å°±æ˜¯æˆ‘ä»¬èƒ½å¤Ÿåœ¨ Retrofit 2 æŠŠ OkHttp ä»¥å…¬å¼€æ¥å£çš„æ–¹å¼ç›´æ¥å¯¼å‡ºã€‚ä½ å¯èƒ½åœ¨ error body æ–¹æ³•æˆ–è€…å“åº”é‡Œè§åˆ°è¿‡ response body çš„å†…å®¹ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬åœ¨ Retrofit çš„ Reponse å¯¹è±¡é‡Œç›´æ¥è¿”å›äº† OkHttp çš„ Response bodyã€‚æˆ‘ä»¬æ­£åœ¨å¯¼å‡ºè¿™äº›ç±»å‹ï¼ŒOkHttp çš„ç±»å‹åŸºæœ¬ä¸Šå·²ç»ä»¥æ›´å¥½æ›´ç®€æ´çš„ API æ›¿ä»£ Retrofit 1.0 çš„ä¸€äº›æ¥å£ã€‚</p>
<p>OkHttp çš„èƒŒåæ˜¯ä¸€ä¸ªå«åš Okio çš„åº“ï¼Œæä¾›çš„ IO æ”¯æŒã€‚æˆ‘ä¹‹å‰åœ¨ <a href="https://youtu.be/WvyScM_S88c" target="_blank" rel="noopener">Droidcon Montreal</a> åšè¿‡å…³äºè¿™ä¸ªåº“çš„æ¼”è®²ã€‚è®¨è®ºè¿‡ä¸ºä»€ä¹ˆå®ƒæ˜¯ä¼—å¤š IO åº“ä¸­æ›´å¥½çš„é€‰æ‹©ï¼Œè¿˜è®¨è®ºäº†å®ƒä¸ºä½•æåº¦é«˜æ•ˆï¼Œä»¥åŠä¸ºä»€ä¹ˆä½ åº”è¯¥ä½¿ç”¨å®ƒä»¬ã€‚æ¼”è®²ä¸­æˆ‘è¿˜æåˆ° Retrofit 2 ï¼Œå½“æ—¶å®ƒè¿˜æ˜¯è„‘æµ·é‡Œçš„ä¸€ä¸ªæ¦‚å¿µã€‚ç°åœ¨ Retrofit 2 å·²ç»å®ç°äº†ã€‚</p>
<h3 id="Retrofit-2-çš„æ•ˆç‡-27-31"><a href="#Retrofit-2-çš„æ•ˆç‡-27-31" class="headerlink" title="Retrofit 2 çš„æ•ˆç‡ (27:31);)"></a>Retrofit 2 çš„æ•ˆç‡ <a href="javascript:presentz.changeChapter(0,142,true" target="_blank" rel="noopener">(27:31)</a>;)</h3><p>æˆ‘åšäº†è¿™ä¸ªå›¾è¡¨æ¥å±•ç¤º Retrofit ç›¸æ¯” Retrofit 1 ä»¥åŠå…¶ä»–å¯èƒ½çš„æ–¹æ¡ˆè¦é«˜æ•ˆçš„å¤šï¼Œè¿™å½’åŠŸäºåˆšåˆšæåˆ°çš„ç¡¬æ€§ä¾èµ–å’Œé‚£äº›æŠ½è±¡ã€‚æˆ‘å¸¦å¤§å®¶æ¥çœ‹ä¸€ä¸‹ä¸Šé¢è§†é¢‘ä¸­çš„è¿™ä¸ªè¡¨ã€‚æ‰€ä»¥ä¸€å®šè¦çœ‹æˆ‘æ¼”è®²çš„è¿™<a href="javascript:presentz.changeChapter(0,142,true" target="_blank" rel="noopener">éƒ¨åˆ†</a>;)å™¢ï¼</p>
<h3 id="åˆå§‹åŒ–-Retrofit-ç±»å‹-31-24"><a href="#åˆå§‹åŒ–-Retrofit-ç±»å‹-31-24" class="headerlink" title="åˆå§‹åŒ– - Retrofit ç±»å‹ (31:24);)"></a>åˆå§‹åŒ– - Retrofit ç±»å‹ <a href="javascript:presentz.changeChapter(0,164,true" target="_blank" rel="noopener">(31:24)</a>;)</h3><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ Retrofit çš„ç±»å‹æ˜¯å¦‚ä½•æ›¿ä»£ REST adapter ç±»å‹çš„ï¼Œä»¥åŠå¦‚ä½•åˆå§‹åŒ–ã€‚åŸæ¥çš„æ–¹æ³•å«åš <code>endpoint</code>, ä¸è¿‡ç°åœ¨æˆ‘ä»¬ç§°ä¹‹ä¸º <code>baseUrl</code>, <code>baseUrl</code> å°±æ˜¯ä½ æ‰€è¯·æ±‚çš„ Server çš„ URLï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªè¯·æ±‚ GitHub Api çš„ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">    .baseUrl(&quot;https://api.github.com&quot;)</span><br><span class="line">    .build();</span><br><span class="line"></span><br><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GitHubService gitHubService = retrofit.create(GitHubService.class);</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å£°æ˜äº†è‡ªå·±çš„æ¥å£ï¼Œæˆ‘ä»¬ç§°ä½œåˆ›å»ºæ–¹æ³•ï¼Œè·Ÿ Retrofit 1 é‡Œçš„æ˜¯ä¸€è‡´çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥ç”Ÿæˆä¸€ä¸ªæ¥å£çš„å®ç°ï¼Œä»¥ä½¿è¿™äº›æ¥å£æ–¹æ³•å¯ä»¥ç›´æ¥è¢«è°ƒç”¨ã€‚</p>
<p>å½“æˆ‘ä»¬è°ƒç”¨ <code>repoContributors</code> è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼ŒRetrofit ä¼šåˆ›å»ºè¿™ä¸ª URLã€‚å¦‚æœæˆ‘ä»¬ä¼ å…¥ <code>Square</code> å’Œ <code>Retrofit</code> å­—ç¬¦ä¸²ï¼Œåˆ†åˆ«ä½œä¸º <code>owner</code> å’Œ <code>repo</code> å‚æ•°ã€‚æˆ‘ä»¬å°±ä¼šå¾—åˆ°è¿™ä¸ª URLï¼š<code>https://api.github.com/repos/square/retrofit/contributors</code>ã€‚åœ¨ Retrofit å†…éƒ¨ï¼ŒRetrofit ä¼šç”¨ OkHttp çš„ HTTP URL ç±»å‹ä½œä¸º åŸºç¡€çš„ URL ï¼Œç„¶å <code>resolve</code> æ–¹æ³•å°±ä¼šå–å‡ºç›¸å¯¹åœ°å€å’Œ baseUrl æ‹¼æ¥èµ·æ¥ï¼Œæ¥ç€å‘èµ·è¯·æ±‚ã€‚æ¥ä¸‹æ¥ç»™ä½ å±•ç¤ºä¸‹æ”¹å˜ API å‰ç¼€ï¼Œæ¯”å¦‚ V3ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">    .baseUrl(&quot;https://api.github.com/v3/&quot;)</span><br><span class="line">    .build();</span><br><span class="line"></span><br><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è™½ç„¶è¯´è¿™ä¸æ˜¯ GitHub çœŸå®çš„ APIï¼Œä½†æ˜¯çœŸå®ä¸–ç•Œé‡Œå°±æ˜¯æœ‰å¾ˆå¤š API æ˜¯ç”±è¿™æ ·çš„å‰ç¼€å’Œè·¯å¾„ç»„æˆçš„ã€‚è°ƒç”¨ç›¸åŒçš„æ–¹æ³•ï¼Œè¢«è§£æå‡ºæ¥çš„ URL å°†ä¼šæ˜¯æ˜¯è¿™æ ·çš„ï¼š <code>https://api.github.com/repos/square/retrofit/contributors</code>ã€‚å¯ä»¥çœ‹åˆ°åœ¨ä¸»æœºåœ°å€ä¹‹åå¹¶æ²¡æœ‰<code>v3</code> ï¼Œè¿™æ˜¯å› ä¸ºåœ°å€çš„ URL æ˜¯ä»¥ä¸€ä¸ªæ–œçº¿å¼€å§‹çš„ï¼Œè€Œåœ¨ HTTP é‡Œï¼Œæ–œçº¿å¼€å§‹çš„åœ°å€å¾€å¾€æ˜¯ç»å¯¹åœ°å€åç¼€è·¯å¾„ã€‚Retrofit 1 ä¼šå› ä¸ºè¯­ä¹‰åŒ–çš„çº¦æŸï¼Œå¼ºåˆ¶ä½ åŠ è¿™ä¸ªå‰ç¼€æ–œçº¿, ç„¶åæŠŠ baseUrl å’Œç›¸å¯¹åœ°å€æ‹¼æ¥èµ·æ¥ã€‚ç°åœ¨ï¼Œè€ƒè™‘åˆ°è§„èŒƒé—®é¢˜ï¼Œæˆ‘ä»¬å·²ç»å¯¹è¿™ä¸¤ç§åœ°å€åŠ ä»¥åŒºåˆ†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæœ‰å‰ç¼€ <code>/</code> å°±ä»£è¡¨ç€æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚åˆ é™¤äº†é‚£ä¸ªå‰ç¼€çš„ <code>/</code>ï¼Œ ä½ å°†ä¼šå¾—åˆ°æ­£ç¡®çš„ã€åŒ…å«äº† <code>v3</code> è·¯å¾„çš„å…¨ URLã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">    .baseUrl(&quot;https://api.github.com/v3/&quot;)</span><br><span class="line">    .build();</span><br><span class="line"></span><br><span class="line">interface GitHubService &#123;</span><br><span class="line">  @GET(&quot;repos/&#123;owner&#125;/&#123;repo&#125;/contributors&quot;)</span><br><span class="line">  Call&lt;List&lt;Contributor&gt;&gt; repoContributors(</span><br><span class="line">      @Path(&quot;owner&quot;) String owner,</span><br><span class="line">      @Path(&quot;repo&quot;) String repo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// https://api.github.com/v3/repos/square/retrofit/contributors</span><br></pre></td></tr></table></figure>
<p>ç”±äºç°åœ¨æˆ‘ä»¬å¼€å§‹ä¾èµ– OkHttpï¼Œ å¹¶æ²¡æœ‰ Http Client å±‚çš„æŠ½è±¡ã€‚ç°åœ¨æ˜¯å¯ä»¥ä¼ é€’ä¸€ä¸ªé…ç½®å¥½çš„ OkHttp å®ä¾‹çš„ã€‚æ¯”å¦‚ï¼šé…ç½® interceptors, æˆ–è€…ä¸€ä¸ª SSL socket å·¥å‚ç±»ï¼Œ æˆ–è€… timeouts çš„å…·ä½“æ•°å€¼ã€‚ ï¼ˆOkHttp æœ‰é»˜è®¤çš„è¶…æ—¶æœºåˆ¶ï¼Œå¦‚æœä½ ä¸éœ€è¦è‡ªå®šä¹‰ï¼Œå®é™…ä¸Šä¸å¿…è¿›è¡Œä»»ä½•è®¾ç½®ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³è¦å»è®¾ç½®å®ƒä»¬ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­å‘Šè¯‰ä½ æ¥æ€ä¹ˆæ“ä½œã€‚ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">OkHttpClient client = new OkHttpClient();</span><br><span class="line">client.interceptors().add(..);</span><br><span class="line"></span><br><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">    .baseUrl(&quot;https://api.github.com&quot;)</span><br><span class="line">    .client(client)</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ è¦æŒ‡æ˜ç‰¹å®šçš„ converter æˆ–è€… execute æœºåˆ¶ï¼Œä¹Ÿæ˜¯åœ¨è¿™ä¸ªæ—¶å€™åŠ çš„ã€‚æ¯”å¦‚è¿™ä¼šå„¿ï¼šæˆ‘ä»¬å¯ä»¥ç»™ GSON è®¾ç½®ä¸€ä¸ªæˆ–è€…å¤šä¸ª converterã€‚ä¹Ÿå¯ä»¥ç»™ protocol buffer è®¾ç½®ä¸€ä¸ª converterã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">    .baseUrl(&quot;https://api.github.com&quot;)</span><br><span class="line">    .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">    .addConverterFactory(ProtoConverterFactory.create())</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>
<p>æˆ‘æƒ³è¦å¼ºè°ƒçš„æ˜¯ï¼š<strong>æ·»åŠ  converter çš„é¡ºåºå¾ˆé‡è¦</strong>ã€‚æŒ‰ç…§è¿™ä¸ªé¡ºåºï¼Œæˆ‘ä»¬å°†ä¾æ¬¡è¯¢é—®æ¯ä¸€ä¸ª converter èƒ½å¦å¤„ç†ä¸€ä¸ªç±»å‹ã€‚æˆ‘ä¸Šé¢å†™çš„å…¶å®æ˜¯é”™çš„ã€‚å¦‚æœæˆ‘ä»¬è¯•å›¾ååºåˆ—åŒ–ä¸€ä¸ª proto æ ¼å¼ï¼Œå®ƒå…¶å®ä¼šè¢«å½“åš JSON æ¥å¯¹å¾…ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬éœ€è¦è°ƒæ•´ä¸‹é¡ºåºï¼Œå› ä¸ºæˆ‘ä»¬å…ˆè¦æ£€æŸ¥ proto buffer æ ¼å¼ï¼Œç„¶åæ‰æ˜¯ JSONã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">    .baseUrl(&quot;https://api.github.com&quot;)</span><br><span class="line">    .addConverterFactory(ProtoConverterFactory.create())</span><br><span class="line">    .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>
<p>Retrofit çš„æ–‡æ¡£é‡Œå¯èƒ½è¿˜æ²¡è¿™äº›ï¼Œå¦‚æœä½ æƒ³è¦ä½¿ç”¨ RxJava æ¥ä»£æ›¿ call, ä½ éœ€è¦ä¸€ä¸ª Call Adapter Factory:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">    .baseUrl(&quot;https://api.github.com&quot;)</span><br><span class="line">    .addConverterFactory(ProtoConverterFactory.create())</span><br><span class="line">    .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">    .addCallAdapterFactory(RxJavaCallAdapterFactory.create())</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>
<p>Call Adapter Factory æ˜¯ä¸€ä¸ªçŸ¥é“å¦‚ä½•å°† call å®ä¾‹è½¬æ¢æˆå…¶ä»–ç±»å‹çš„å·¥å‚ç±»ã€‚ç›®å‰ï¼Œæˆ‘ä»¬åªæœ‰ RxJava çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯å°† Call ç±»å‹è½¬æ¢æˆ Observable ç±»å‹ã€‚å¦‚æœä½ äº†è§£ RxJava, å…¶å®è¿˜æœ‰ä¸€ç§æ–°çš„ Observable ç±»å‹ï¼ˆä¸€æ¬¡åªå‘å°„ä¸€ä¸ª item çš„ç±»å‹ï¼‰ã€‚ä½ å¯ä»¥ç”¨è¿™ä¸ª call adapter factory æ¥è½¬æ¢åˆ°å…¶ä¸­ä»»æ„ä¸€ç§ Observableã€‚</p>
<h3 id="æ‰©å±•æ€§-36-50"><a href="#æ‰©å±•æ€§-36-50" class="headerlink" title="æ‰©å±•æ€§ (36:50);)"></a>æ‰©å±•æ€§ <a href="javascript:presentz.changeChapter(0,187,true" target="_blank" rel="noopener">(36:50)</a>;)</h3><p>åˆšæ‰æåˆ°çš„ Factoryï¼Œä¹Ÿæ˜¯å¯æ‰©å±•çš„ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥å†™å±äºè‡ªå·±çš„ Call Adapter Facotryã€‚å®ç°èµ·æ¥å…¶å®å°±æ˜¯ä¸€ä¸ªæ–¹æ³•ã€‚ä¼ é€’ç»™å®ƒä¸€ä¸ªç±»å‹ï¼Œè¿”å› null ä»£è¡¨æ‹’ç»ï¼Œæˆ–è€…è¿”å›ä¸€ä¸ª converter çš„å®ä¾‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SomeJsonResponse</span><br><span class="line"></span><br><span class="line">		class ProtoConverterFactory &#123;</span><br><span class="line">  			Converter&lt;?&gt; create(Type type);		null</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		class GsonConverterFactory &#123;</span><br><span class="line">			Converter&lt;?&gt; create(Type type);		Converter&lt;?&gt;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸Šé¢çš„ä¾‹å­ï¼Œå¦‚æœä½ ç»™å®ƒä¼ é€’ä¸€ä¸ª JSON çš„ Respnose ç±»å‹ï¼Œè¿™ä¸ªç±»å‹ä¸æ˜¯ä» proto ç»§æ‰¿è€Œæ¥ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¯´ï¼šâ€æˆ‘ä¸çŸ¥é“å¦‚ä½•ä¼ é€’è¿™ä¸ªï¼Œæ‰€ä»¥æˆ‘è¿”å›ç©ºå€¼ null.ã€ï¼Œç„¶è€Œï¼Œå¯¹äº GSON converter è€Œè¨€ï¼Œå®ƒé€šè¿‡è¿”å›ä¸€ä¸ªå®ä¾‹æ¥è¡¨æ˜å®ƒå¯ä»¥å¤„ç†è¿™ä¸ªç±»å‹çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªç±»æ˜¯ä¸€ä¸ªå·¥å‚ç±»ï¼Œå› ä¸ºæˆ‘ä»¬è®©å®ƒç”Ÿäº§ converter å®ä¾‹ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦åšä¸€äº›è‡ªå®šä¹‰ï¼Œå®ç°èµ·æ¥æ˜¯éå¸¸å®¹æ˜“çš„ã€‚Converter çš„å®ç°ä¸ä¹‹å‰çš„å®ç°æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œå°½ç®¡ä»£æ›¿ç±»å‹åŒ–çš„è¾“å…¥å’Œè¾“å‡ºï¼Œæˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„æ˜¯ OkHttp çš„è¯·æ±‚body å’Œç›¸åº” bodyã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface Converter&lt;T&gt; &#123;</span><br><span class="line">  interface Factory &#123;</span><br><span class="line">	Converter &lt;?&gt; create(Type type);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  T fromBody(ResponseBody body);</span><br><span class="line">  RequestBody toBody(T value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨è¿™å·²ç»é«˜æ•ˆçš„å¤šï¼Œå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥æŸ¥è¯¢é‚£äº› adapterã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒGSON æœ‰ä¸€ä¸ªtype adapter, å½“æˆ‘ä»¬è¯·æ±‚ GSON Converter Factoryï¼Œè¯¢é—®å®ƒæ˜¯å¦å¯ä»¥å¤„ç†æŸç§è¯·æ±‚çš„æ—¶å€™ï¼Œ converter factory å°±å¼€å§‹æŸ¥è¯¢è¿™ä¸ª adapter, å®ƒå°†ä»¥ç¼“å­˜çš„å½¢å¼å­˜åœ¨ï¼Œå½“æˆ‘ä»¬å†æ¬¡æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ä¸ª adapter å°±å¯ä»¥ç›´æ¥è¢«ä½¿ç”¨äº†ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å°çš„æˆåŠŸï¼ŒæåŠ›é¿å…äº†ä¸æ–­åœ°æŸ¥è¯¢å¸¦æ¥çš„æŸè€—ã€‚</p>
<p>call adapter æœ‰ç›¸åŒçš„æ¨¡å¼ã€‚æˆ‘ä»¬è¯¢é—®ä¸€ä¸ª call adapter factory å®ƒæ˜¯å¦å¯ä»¥å¤„ç†æŸä¸ªç±»å‹ï¼Œå®ƒå°†ä¼šä»¥ç›¸åŒçš„æ–¹å¼å›åº”ã€‚ï¼ˆä¾‹å¦‚ï¼šå®ƒä¼šè¿”å› null æ¥è¡¨è¾¾å¦ï¼‰ã€‚å®ƒçš„API æ˜¯éå¸¸ç®€å•çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface CallAdapter&lt;T&gt; &#123;</span><br><span class="line">  interface Factory &#123;</span><br><span class="line">    CallAdapter&lt;?&gt; create(Type type);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Type responseType();</span><br><span class="line">  Object adapt(Call&lt;T&gt; value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹æ³•æ¥æ¥å®ç°é€‚é…ã€‚ä¼ å…¥ä¸€ä¸ª call å®ä¾‹ï¼Œè¿”å›äº†ä¸€ä¸ª observableï¼Œsingle æˆ–è€… future ç­‰ã€‚ è¿˜æœ‰ä¸€ç§æ–¹æ³•æ¥è·å¾—è¿™ç§ response ç±»å‹ï¼šå½“æˆ‘ä»¬å£°æ˜ä¸€ç³»åˆ— contributor è°ƒç”¨æ—¶ï¼Œ æˆ‘ä»¬æ²¡æ³•è‡ªåŠ¨æŠŠé‚£äº›å‚æ•°åŒ–çš„ç±»å‹æå–å‡ºæ¥ï¼Œå› æ­¤æˆ‘ä»¬åŸºæœ¬ä¸Šåªæ˜¯è¯·æ±‚è¿™ä¸ª call adapter ä¹Ÿè¿”å›è¿™ä¸ª response typeã€‚å¦‚æœä½ ä¸ºè¿™ä¸ªå˜é‡åˆ›é€ äº†ä¸€ä¸ªå®ä¾‹ï¼Œæˆ‘ä»¬ä¼šè¯·æ±‚ call adapter, å®ƒä¼šå°† contributor type åˆ—è¡¨è¿”å›ã€‚</p>
<h3 id="è¿˜åœ¨å»ºè®¾ä¸­-40-05"><a href="#è¿˜åœ¨å»ºè®¾ä¸­-40-05" class="headerlink" title="è¿˜åœ¨å»ºè®¾ä¸­ (40:05);)"></a>è¿˜åœ¨å»ºè®¾ä¸­ <a href="javascript:presentz.changeChapter(0,204,true" target="_blank" rel="noopener">(40:05)</a>;)</h3><p>Retrofit 2 æ­£åœ¨å®Œå–„ä¸­ï¼ç°åœ¨è¿˜ä¸å¤Ÿå®Œæ•´ï¼Œä½†æ˜¯å·²ç»å¯ä»¥ç”¨äº†ã€‚æˆ‘ä¸Šé¢æåˆ°çš„ç‚¹éƒ½æ˜¯å·²ç»å®Œæˆäº†çš„ï¼Œé‚£è¿˜æœ‰å“ªäº›æœªå®Œæˆå‘¢ï¼Ÿ</p>
<p>å…³äºæ‰€è°“çš„â€œå‚æ•° handlerâ€æˆ‘ä»¬ç°åœ¨è¿˜æ²¡æœ‰ä¸€ä¸ªæˆç†Ÿçš„æƒ³æ³•ã€‚æˆ‘ä»¬æœªæ¥æƒ³è¦è®©å®ƒæœ‰ä» Guava ä¼ é€’å¤šä¸ª mapï¼Œæˆ–è€…æ•°æ®ç±»å‹åŠæšä¸¾ç±»å‹ã€‚</p>
<p>æ—¥å¿—åŠŸèƒ½è¿˜æ²¡æœ‰å®Œæˆï¼Œåœ¨ Retrofit 1 é‡Œæ˜¯æœ‰æ—¥å¿—çš„ï¼Œä½†æ˜¯åœ¨ Retrofit 2 é‡Œé¢æ²¡æœ‰ã€‚ä¾èµ– OkHttp çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ä½ å®é™…ä¸Šå¯ä»¥ä½¿ç”¨ä¸€ä¸ª interceptor æ¥å®ç°å®é™…çš„åº•å±‚çš„è¯·æ±‚å’Œå“åº”æ—¥å¿—ã€‚å› æ­¤ï¼Œå¯¹äºåŸå§‹è¯·æ±‚å’Œå“åº”ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å®ƒï¼Œä½†æ˜¯æˆ‘ä»¬å¾ˆå¯èƒ½éœ€è¦æ—¥å¿—æ¥è®°å½• Java ç±»å‹ã€‚</p>
<p>å¦‚æœä½ æ›¾ç»ä½¿ç”¨è¿‡ mock æ¨¡å—ï¼Œä½ ä¼šå‘ç°å®ƒä¹Ÿè¿˜æ²¡è¢«å®Œæˆï¼Œä½†å¾ˆå¿«ä¼šå®Œæˆçš„ã€‚</p>
<p>ç°åœ¨æ–‡æ¡£ä¾ç„¶æ¯”è¾ƒç¼ºã€‚</p>
<p>æœ€åï¼Œåœ¨æˆ‘æœ‰ç©ºçš„æ—¶å€™ï¼Œæˆ‘æƒ³åœ¨ Retrofit 2 é‡Œæ”¯æŒ WebSocketã€‚åœ¨ 2.0 é‡Œå¾ˆå¯èƒ½æ— æ³•å®ç°ï¼Œä½†æ˜¯æˆ‘æƒ³åœ¨åç»­çš„2.1 ç‰ˆæœ¬é‡Œä¼šåŠ å…¥æ”¯æŒã€‚</p>
<h3 id="Release-41-31"><a href="#Release-41-31" class="headerlink" title="Release? (41:31);)"></a>Release? <a href="javascript:presentz.changeChapter(0,210,true" target="_blank" rel="noopener">(41:31)</a>;)</h3><p>æˆ‘ä¿è¯è¿‡ Retrofit 2 ä»Šå¹´ä¼šå’Œå¤§å®¶è§é¢ï¼Œä»Šå¹´ç¡®å®å¯ä»¥ã€‚è‡³äºå…·ä½“å“ªå¤©é—®ä¸–ï¼Œæˆ‘ä»¬ä¸ä¼šåšä»»ä½•æ‰¿è¯ºã€‚æˆ‘ä¸æƒ³å†åœ¨ 2016 çš„ DroidCons ä¸Šå¼€ç›¸åŒçš„ç©ç¬‘ã€‚å› æ­¤ä»Šå¹´ä¸€å®šä¼šé—®ä¸–ã€‚æˆ‘ä¿è¯ã€‚è‡³äº2015å¹´8æœˆ27æ—¥ï¼Œæˆ‘å·²ç»å¼€æ”¾äº†ä¸€ä¸ª2.0çš„æµ‹è¯•ç‰ˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">  compile &apos;com.squareup.retrofit:retrofit:2.0.0-beta1&apos;</span><br><span class="line">  compile &apos;com.squareup.retrofit:converter-gson:2.0.0-beta1&apos;</span><br><span class="line">  compile &apos;com.squareup.retrofit:adapter-rxjava:2.0.0-beta1&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥ä¾èµ–å®ƒã€‚å®ƒå·²ç»å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼ŒAPI æ¥å£ä¹Ÿç›¸å¯¹ç¨³å®šã€‚Converter å’Œ converter å·¥å‚æ–¹æ³•æœªæ¥å¯èƒ½ä¼šæ”¹å˜ï¼Œä½†æ˜¯æ€»ä½“æ¥è¯´æ˜¯æœ‰ç”¨çš„ã€‚è¦æ˜¯ä½ æœ‰ä»€ä¹ˆä¸å–œæ¬¢æˆ–è€…æœ‰é—®é¢˜çš„åœ°æ–¹ï¼Œè¯·è”ç³»æˆ‘ï¼è°¢è°¢ï¼</p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/retrofit/">retrofit</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/ã€Noteã€‘ã€Šæ„å»ºä¹‹æ³•ã€‹æè¦"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/ã€Noteã€‘ã€Šæ„å»ºä¹‹æ³•ã€‹æè¦/">ã€Noteã€‘ã€Šæ„å»ºä¹‹æ³•ã€‹æè¦</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/ã€Noteã€‘ã€Šæ„å»ºä¹‹æ³•ã€‹æè¦/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/é˜…è¯»/">é˜…è¯»</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>ã€Šè½¯ä»¶å·¥ç¨‹  æ„å»ºä¹‹æ³•ã€‹ä½œè€…é‚¹æ¬£ç³»Windowsä¸­å›½å·¥ç¨‹å¸ˆå›¢é˜Ÿé¦–å¸­ç ”å‘æ€»ç›‘ ï¼ˆLinkï¼š<a href="https://www.amazon.cn/å›¾ä¹¦/dp/B011LPUAYI/ref=sr_1_1?ie=UTF8&amp;qid=1487685207&amp;sr=8-1&amp;keywords=æ„å»ºä¹‹æ³•" target="_blank" rel="noopener">äºšé©¬é€Š</a>ï¼‰</p>
</blockquote>
<blockquote>
<p>æ•´æœ¬ä¹¦ï¼Œæå…¶è®¤çœŸï¼Œç»“æ„ç»„ç»‡çš„æœ‰ç‚¹åƒå­¦æœ¯è®ºæ–‡äº†ã€‚æ¶µç›–é¢æ¯”è¾ƒå…¨ï¼Œæ¶‰åŠåˆ°äº†ç°ä»£è½¯ä»¶å·¥ç¨‹çš„æ•´ä¸ªæµç¨‹ï¼Œä»éœ€æ±‚çš„æŒ–æ˜äº§ç”Ÿï¼Œåˆ°ä¸­é—´å„ä¸ªç¯èŠ‚åœ°å¾ªåºæ¸è¿›ï¼Œç›´è‡³æœ€åçš„äº¤ä»˜ä¸ç»´æŠ¤æ”¯æŒã€‚å¿…ç„¶ä¹Ÿå°±å¯¼è‡´æ¯ä¸ªç‚¹æ·±å…¥ç¨‹åº¦ç›¸å¯¹è¾ƒæœ‰é™ã€‚</p>
</blockquote>
<blockquote>
<p>é™¤äº†é¡¹ç›®æœ¬èº«ï¼Œæœ¬ä¹¦å¦ä¸€ä¸ªå…³æ³¨é‡ç‚¹æ˜¯é¡¹ç›®ä¸­çš„äººï¼šé¡¹ç›®ç»ç†ã€ç”¨æˆ·ã€æµ‹è¯•ã€å¼€å‘ï¼Œè®²åˆ°å„ç§è§’è‰²å„è‡ªçš„èŒè´£ï¼Œç›¸äº’ä¹‹é—´çš„åä½œå…³ç³»ã€åˆä½œæ–¹æ³•ï¼Œæœ€åä¸€ç« ä¸­è¿˜æœ‰æåˆ°èŒä¸šé“å¾·~ï¼ˆæ„Ÿè§‰æœ‰ç‚¹åå‘è‚¡ä¸œä¸é›‡ä¸»ï¼‰</p>
</blockquote>
<blockquote>
<p>å…¨ä¹¦æ›´å¤šçš„æ˜¯æ¢è®¨æ–¹æ³•è®ºï¼Œå…³äºå¼€å‘ã€å…³äºæ•æ·è¿­ä»£ã€å…³äºé¡¹ç›®ç®¡ç†ã€å…³äºç»“å¯¹ç¼–ç¨‹ã€å…³äºæµ‹è¯•æµç¨‹ä¸ç§ç±»ã€å…³äºç”¨æˆ·ä½“éªŒçš„è·å¾—ä¸æ”¹è¿›ã€å…³äºéœ€æ±‚åˆ†æä¸è¯„å®¡ã€å…³äºè½¯ä»¶å·¥ç¨‹å¸ˆçš„æˆé•¿ã€‚å½“ç„¶ä½œè€…åªæ˜¯æä¾›äº†ä¸€äº›è‡ªå·±çš„è§è§£ï¼Œå¾ˆå¤šè§‚ç‚¹å¹¶ä¸ä¸€å®šå‡†ç¡®ï¼Œå…¶ä¸­ä¹Ÿæœ‰ä¸€äº›è½ä¼çš„å·¥å…·ã€æ¨¡å‹ã€‚</p>
</blockquote>
<blockquote>
<p>æ›´å¤§çš„æ„ä¹‰è®¸æ˜¯å…¨é¢åœ°æ¦‚è¿°ä¸€äº›éœ€è¦æ³¨æ„çš„ç‚¹ï¼ŒçœŸæ­£è´¯å½»è½å®è¿™äº›æ–¹æ³•éœ€è¦è€—è´¹æå¤§æˆæœ¬ã€‚å¾ˆå¤šè§‚ç‚¹å¼•äººæ·±æ€ã€‚</p>
</blockquote>
<hr>
<p><a href="https://www.evernote.com/l/ARsVoFkwFjJCdY6Llj0jxODvRc2NPL8xgTI" target="_blank" rel="noopener">EverNoteé“¾æ¥</a></p>
<p><a href="https://www.evernote.com/shard/s283/sh/15a05930-1632-4275-8e8b-963d23c4e0ef/45cd8d3cbf318132/res/7853730d-412e-4220-9b6a-4fda39ca66a8/æ„å»ºä¹‹æ³•.xmind" target="_blank" rel="noopener">XMindæ–‡æ¡£</a></p>
<p><strong>å¯¼å›¾</strong></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1481332-7bcaba0014f30279.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ„å»ºä¹‹æ³• overview.png"></p>
<p><strong>æ–‡æœ¬</strong><br>æ„å»ºä¹‹æ³•</p>
<p>1 ä¸ªäºº<br>  1.1 2 ä¸ªäººå’ŒæŠ€æœ¯æµç¨‹<br>    1.1.1 å•å…ƒæµ‹è¯•<br>        1.1.1.1 ç€çœ¼äºåŸºæœ¬ç‚¹ï¼›å½“äº‹äººç¼–å†™ï¼›ä¸æ”¹å˜æœºå™¨çŠ¶æ€ï¼›å¿«ï¼›å¯é‡ç°ï¼›è¦†ç›–æ‰€æœ‰ä»£ç è·¯å¾„ï¼›ä¸äº§å“ä»£ç ä¸€åŒç»´æŠ¤<br>    1.1.2 æ•ˆèƒ½åˆ†æå·¥å…·<br>        1.1.2.1 æŠ½æ ·ã€ä»£ç æ³¨å…¥<br>    1.1.3 ä¸ªäººå¼€å‘æµç¨‹<br>        1.1.3.1 è®¡åˆ’ã€å¼€å‘ã€è®°å½•ç”¨æ—¶ã€æµ‹è¯•æŠ¥å‘Šã€è®¡ç®—å·¥ä½œé‡ã€äº‹åæ€»ç»“ã€æå‡ºè¿‡ç¨‹æ”¹è¿›è®¡åˆ’<br>  1.2 3 è½¯ä»¶å·¥ç¨‹å¸ˆçš„æˆé•¿<br>    1.2.1 å¤§æ±Ÿä¸œå»ï¼Œæµªæ·˜å°½ï¼Œåƒå¤é£æµäººç‰©<br>2 å›¢é˜Ÿ<br>  2.1 4 ä¸¤äººåˆä½œ<br>    2.1.1 ä»£ç è§„èŒƒã€è®¾è®¡è§„èŒƒã€å¤å®¡ï¼ˆé©³å›ï¼Œé€‰æ‹©æ€§åŒæ„ï¼Œæ”¾è¡Œï¼‰ã€ç»“å¯¹ç¼–ç¨‹ã€ä¸åŒé˜¶æ®µçš„æŠ€å·§<br>  2.2 5 å›¢é˜Ÿå’Œæµç¨‹<br>    2.2.1 å›¢é˜Ÿæ¨¡å¼ã€å¼€å‘æµç¨‹<br>  2.3 6 æ•æ·æµç¨‹<br>    2.3.1 æ•æ·é—®é¢˜ä¸è§£æ³•ã€æ•æ·å›¢é˜Ÿï¼ˆè‡ªä¸»ï¼‰ã€æ•æ·æ€»ç»“<br>  2.4 7 MSF<br>    2.4.1 MSFåŸºæœ¬åŸåˆ™ï¼ˆå…±äº«ã€æ²Ÿé€šã€ä¸ºå…±åŒç›®æ ‡åŠªåŠ›ã€å……åˆ†æˆæƒå’Œä¿¡ä»»ã€å„å¸å…¶èŒã€æ•æ·ï¼‰ï¼›MSFå›¢é˜Ÿæ¨¡å‹<br>3 äº§å“<br>  3.1 8 éœ€æ±‚åˆ†æ<br>    3.1.1 è½¯ä»¶éœ€æ±‚ï¼ˆè·å–å¼•å¯¼ã€åˆ†æå®šä¹‰ã€éªŒè¯ã€ç®¡ç†ï¼‰ï¼›åˆ©ç›Šç›¸å…³è€…ï¼›ç”¨æˆ·è°ƒç ”ï¼ˆç„¦ç‚¹å°ç»„ã€äººç±»å­¦ã€å¿«é€ŸåŸå‹ã€ABæµ‹è¯•ï¼‰ï¼›ç«äº‰æ€§éœ€æ±‚åˆ†ææ¡†æ¶ï¼ˆNeedã€Approachã€Benefitã€Competitorsã€Deliveryï¼‰ï¼›åŠŸèƒ½å®šä½ä¸ä¼˜å…ˆçº§ï¼ˆå¿…è¦ä¸è¾…åŠ©ã€æ ¸å¿ƒä¸å¤–å›´ï¼‰ï¼›è®¡åˆ’ä¸ä¼°è®¡ï¼›åˆ†è€Œæ²»ä¹‹<br>  3.2 9 é¡¹ç›®ç»ç†<br>    3.2.1 æ¥å†ï¼›èŒè´£ï¼ˆå¼€å‘ä¸æµ‹è¯•ä¹‹å¤–çš„æ‰€æœ‰ï¼‰ï¼›PMä¸é£é™©ç®¡ç†ï¼›èƒ½åŠ›è¦æ±‚ä¸ä»»åŠ¡ï¼ˆè§‚å¯Ÿç†è§£å¿«é€Ÿå­¦ä¹ ã€åˆ†æç®¡ç†ã€ä¸“ä¸šã€è‡ªçœï¼‰<br>  3.3 10 å…¸å‹ç”¨æˆ·å’Œåœºæ™¯<br>  3.4 12 ç”¨æˆ·ä½“éªŒ<br>    3.4.1 è¦ç´ ï¼ˆç¬¬ä¸€å°è±¡ã€æ¢ä½æ€è€ƒã€è®°ä½ç”¨æˆ·é€‰æ‹©â€¦ï¼‰ï¼›è®¾è®¡çš„æ­¥éª¤ä¸ç›®æ ‡ï¼›è¯„ä»·æ ‡å‡†ï¼ˆå¿«åé¦ˆã€è´´è¿‘ç°å®ã€æš´éœ²æ§åˆ¶æƒã€ä¸€è‡´æ€§ä¸æ ‡å‡†åŒ–ã€é€‚åˆå„ç§ç”¨æˆ·ã€å¸®åŠ©ä¿®å¤ï¼›æç¤ºè¯­å¸®åŠ©ï¼‰<br>4 è´¨é‡<br>  4.1 11 è½¯ä»¶è®¾è®¡ä¸å®ç°<br>    4.1.1 åˆ†æä¸è®¾è®¡æ–¹æ³•ï¼›å›¢é˜Ÿå»ºæ¨¡å’Œåˆ†ææ–¹æ³•ï¼›æ—¥å¸¸ç®¡ç†ï¼›<br>  4.2 13 è½¯ä»¶æµ‹è¯•<br>    4.2.1 åˆ†ç±»æ–¹æ³•ï¼ˆé»‘ç™½ã€åŠŸèƒ½éåŠŸèƒ½ã€æ—¶æœºä½œç”¨åˆ†ç±»ï¼‰ï¼›æµ‹è¯•æ–¹æ³•ï¼ˆUnitTestã€BuildTestã€AcceptanceTestã€æ¢ç´¢æµ‹è¯•ã€å›å½’æµ‹è¯•ã€åœºæ™¯/é›†æˆ/ç³»ç»Ÿæµ‹è¯•ã€ä¼™ä¼´æµ‹è¯•ã€æ•ˆèƒ½æµ‹è¯•ã€å‹åŠ›æµ‹è¯•ã€å†…å¤–éƒ¨æµ‹è¯•ã€æ˜“ç”¨æ€§æµ‹è¯•ï¼‰<br>  4.3 14 è´¨é‡ä¿éšœ<br>    4.3.1 è½¯ä»¶è´¨é‡ï¼ˆç¨‹åºã€å·¥ç¨‹ã€å¦‚ä½•è¡¡é‡ã€æˆæœ¬ï¼‰ï¼›è´¨é‡ä¿éšœå·¥ä½œï¼ˆæµ‹è¯•è§’è‰²ï¼‰<br>  4.4 15 ç¨³å®šå’Œå‘å¸ƒé˜¶æ®µ<br>    4.4.1 ä»å®Œæˆåˆ°å‘å¸ƒï¼›æ¸è¿›å‘å¸ƒï¼›å‘å¸ƒä¹‹åâ€”â€”äº‹åè¯¸è‘›äº®ä¼šè®®ï¼ˆèµç½šã€æ€»ç»“ç»éªŒæ•™è®­ï¼‰<br>5 IT<br>  5.1 16 ITè¡Œä¸šçš„åˆ›æ–°<br>    5.1.1 äº‰è®®ç‚¹ï¼ˆåˆ›æ–°ä¸è·Ÿéšã€é¼»ç¥–ä¸å¸ƒé“ã€ä¸“å®¶ï¼Ÿã€æŠ€æœ¯åˆ›æ–°ä¸ºæ ¸å¿ƒï¼Ÿã€æˆåŠŸè€…æ›´èƒ½åˆ›æ–°ï¼Ÿï¼‰ï¼›æ—¶æœºï¼›æ‹›æ•°<br>  5.2 17 äººã€ç»©æ•ˆå’ŒèŒä¸šé“å¾·<br>    5.2.1 çŒªé¸¡é¹¦é¹‰ï¼ˆæˆå‘˜æŠ•å…¥ç¨‹åº¦ä¸ä¸€ï¼‰ï¼›äººï¼›ç»©æ•ˆç®¡ç†ï¼›èŒä¸šé“å¾·ï¼ˆä¸å…¬ä¼—åˆ©ç›Šä¸€è‡´ã€å®¢æˆ·ä¸é›‡ä¸»åˆ©ç›Šæœ€å¤§åŒ–ã€äº§å‡ºç‰©æ»¡è¶³é«˜æ ‡å‡†ã€ä¸“ä¸šåˆ¤æ–­ã€ç®¡ç†è½¯ä»¶ä¸å¼€å‘ç»´æŠ¤ã€èŒä¸šçš„è¯šä¿¡ä¸å£°èª‰ã€å¯¹åŒäº‹çš„æ”¯æŒä¸å¸®åŠ©ã€è‡ªèº«ä¸æ–­æé«˜ï¼‰</p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/è¯»ä¹¦/">è¯»ä¹¦</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/é¡¹ç›®ç®¡ç†/">é¡¹ç›®ç®¡ç†</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/Android/GL check point"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/GL check point/">GL check point</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/GL check point/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="è°ƒæŸ¥ç‚¹ï¼š"><a href="#è°ƒæŸ¥ç‚¹ï¼š" class="headerlink" title="è°ƒæŸ¥ç‚¹ï¼š"></a>è°ƒæŸ¥ç‚¹ï¼š</h2><ol>
<li><p>çº¹ç†æ˜¯å¦å‹ç¼©</p>
<ul>
<li>ç–‘é—®ï¼šä¸åŒGPUæ”¯æŒçš„çº¹ç†æ ¼å¼ä¸ä¸€æ ·ï¼Œéœ€è¦å¯¹GPUåšé€‚é…ï¼Œå·¥ä½œé‡ä¸å°</li>
</ul>
<blockquote>
<p>å¿—æ–‡ï¼šå£çº¸æˆ–è®¸å¯ä»¥åšä¸€äº›å¤„ç†ï¼ˆgo-orgåç¼–è¯‘ä»£ç æœªå‘ç°ç±»ä¼¼å¤„ç†ï¼‰ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œå¯ä»¥å‡7-8Må†…å­˜å ç”¨</p>
</blockquote>
</li>
<li><p>Mipmap</p>
<blockquote>
<p>è™½ç„¶MipmapåŒ…ä¼šæ¯”åŸå§‹å›¾åƒå¤šç”¨æ‰33%çš„å†…å­˜ï¼Œä½†å®ƒä¸ä»…å¯ä»¥æå‡æ€§èƒ½ï¼Œä¹Ÿä¼šæé«˜å›¾åƒè´¨é‡</p>
<blockquote>
<p>ARM Mali GPU Texture Compression Toolå¯ä»¥ç”ŸæˆMipmap</p>
</blockquote>
</blockquote>
<ul>
<li>ç»“è®ºï¼šè¿™ä¸ªåŠŸèƒ½ä¼šæ›´è€—å†…å­˜ï¼Œé€‚ç”¨äºæ¸¸æˆåœºæ™¯ï¼Œorgä¸é€‚ç”¨</li>
</ul>
</li>
<li><p>çº¹ç†å‚æ•°è®¾ç½®</p>
<blockquote>
<p>åŸºæœ¬è¶Šæ…¢çš„å‡½æ•°ï¼Œè§†è§‰è´¨é‡è¶Šé«˜</p>
<p>å‚æ•°é…ç½®å‚è€ƒé“¾æ¥ï¼š<a href="https://www.khronos.org/registry/OpenGL-Refpages/es2.0/" target="_blank" rel="noopener">https://www.khronos.org/registry/OpenGL-Refpages/es2.0/</a></p>
</blockquote>
</li>
<li><p>RenderScript 3D æ¸²æŸ“</p>
</li>
</ol>
<p>é«˜æ–¯æ¨¡ç³Šä¹‹ç±»çš„ä¼˜åŒ–</p>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GL/">GL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Performance/">Performance</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  
    <article id="post-æŠ€æœ¯/Android/GL Launcher memory consume test report"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2018/03/09/æŠ€æœ¯/Android/GL Launcher memory consume test report/">GL exampleModule memory consume test report</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/03/09/æŠ€æœ¯/Android/GL Launcher memory consume test report/" class="article-date">
	  <time datetime="2018-03-08T16:35:35.000Z" itemprop="datePublished">2018-03-09</time>
	</a>

      
    <a class="article-category-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="â€œGLâ€-testéƒ¨åˆ†æ¨¡å—-å†…å­˜å ç”¨æµ‹è¯•"><a href="#â€œGLâ€-testéƒ¨åˆ†æ¨¡å—-å†…å­˜å ç”¨æµ‹è¯•" class="headerlink" title="â€œGLâ€  testéƒ¨åˆ†æ¨¡å— å†…å­˜å ç”¨æµ‹è¯•"></a>â€œGLâ€  testéƒ¨åˆ†æ¨¡å— å†…å­˜å ç”¨æµ‹è¯•</h1><blockquote>
<p>trunk 3.0 #90770</p>
<p>æµ‹è¯•æœºå‹ï¼šN5 6.0</p>
</blockquote>
<h3 id="dumpåœºæ™¯ï¼š"><a href="#dumpåœºæ™¯ï¼š" class="headerlink" title="dumpåœºæ™¯ï¼š"></a>dumpåœºæ™¯ï¼š</h3><ol>
<li>æ­£å¸¸è¿è¡Œâ€”â€”é™ç½®3min</li>
<li>è¿›å…¥è´Ÿä¸€å±</li>
<li>è¿›å…¥3Dæ—¶é’Ÿ</li>
<li>è¿›å…¥AllApps</li>
<li>è¿›å…¥å¤©æ°”</li>
<li>è¿›å…¥æœç´¢</li>
<li>åº”ç”¨3Dä¸»é¢˜ä¹‹å</li>
<li>3Dä¸»é¢˜å…³å±ä¹‹å</li>
<li>ä»3Dåˆ‡å›2D</li>
</ol>
<h2 id="æµ‹è¯•ç»“è®º"><a href="#æµ‹è¯•ç»“è®º" class="headerlink" title="æµ‹è¯•ç»“è®º"></a>æµ‹è¯•ç»“è®º</h2><blockquote>
<p>ä»¥ä¸‹ç»“è®ºåŸºäºN5 6.0æœºå‹ï¼Œç»“æœæœªä¸å…¶å®ƒæœºå™¨ã€å®‰å“ç‰ˆæœ¬åšæ¨ªå‘æ¯”è¾ƒ</p>
</blockquote>
<ul>
<li>testè¿›ç¨‹å†…ï¼Œå„æ¨¡å—åˆ‡æ¢æ—¶æœªå‡ºç°å¤ªå¤§æ³¢åŠ¨</li>
<li>ä½†testèµ·å§‹å€¼ï¼ˆGfx devï¼‰åœ¨ 40000KBï¼ˆ~40Mï¼‰å·¦å³ï¼Œè€ƒè™‘è¿™ä¸€ç‚¹æ˜¯å¦æœ‰æ”¹è¿›å¿…è¦ã€ç©ºé—´ï¼Ÿ</li>
<li>3Dä¸»é¢˜ç›¸è¾ƒ2Dï¼Œå†…å­˜å ç”¨å‡é«˜~17Må·¦å³ï¼ˆå…·ä½“å€¼æœªä¸¥æ ¼æµ‹è¯•ï¼‰</li>
<li>å…³å±ä¹‹åï¼ˆé™ç½®&gt;2minï¼‰ï¼Œæœªå¯¹å†…å­˜å ç”¨åšä¼˜åŒ–å¤„ç†â€”â€”è€ƒè™‘æ˜¯å¦å¯è¡Œï¼Ÿæ˜¯å¦å¿…è¦ï¼Ÿï¼Ÿï¼Ÿ</li>
<li>ä»3Dåˆ‡å›2Dï¼Œå†…å­˜åå¢11Må·¦å³ï¼ˆå¯¹æ­¤dumpæ–‡ä»¶æ„Ÿå…´è¶£çš„åŒå­¦è”ç³»æˆ‘ï¼‰â€”â€”æ­¤å¤„éœ€è¦åˆ†æhprofï¼Œæ‰¾åˆ°é—®é¢˜ç‚¹</li>
</ul>
<h2 id="å®éªŒæ•°æ®"><a href="#å®éªŒæ•°æ®" class="headerlink" title="å®éªŒæ•°æ®"></a>å®éªŒæ•°æ®</h2><h3 id="æ­£å¸¸è¿è¡Œâ€”â€”é™ç½®3min"><a href="#æ­£å¸¸è¿è¡Œâ€”â€”é™ç½®3min" class="headerlink" title="æ­£å¸¸è¿è¡Œâ€”â€”é™ç½®3min"></a>æ­£å¸¸è¿è¡Œâ€”â€”é™ç½®3min</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">16257</span> [com.org.test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">25108</span>    <span class="number">25080</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">43264</span>    <span class="number">36859</span>     <span class="number">6404</span></span><br><span class="line">  Dalvik Heap    <span class="number">42114</span>    <span class="number">42040</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">65438</span>    <span class="number">50717</span>    <span class="number">14721</span></span><br><span class="line"> Dalvik Other     <span class="number">3860</span>     <span class="number">3860</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack     <span class="number">1516</span>     <span class="number">1516</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">176</span>      <span class="number">140</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">41004</span>    <span class="number">41004</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev      <span class="number">136</span>        <span class="number">0</span>      <span class="number">136</span>        <span class="number">0</span></span><br><span class="line">     .so mmap     <span class="number">8610</span>      <span class="number">320</span>      <span class="number">812</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap     <span class="number">2555</span>        <span class="number">0</span>     <span class="number">2100</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">173</span>        <span class="number">0</span>      <span class="number">128</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">29908</span>       <span class="number">48</span>    <span class="number">23812</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">2767</span>        <span class="number">0</span>      <span class="number">900</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">1705</span>     <span class="number">1528</span>        <span class="number">4</span>        <span class="number">0</span></span><br><span class="line">   Other mmap     <span class="number">1078</span>        <span class="number">8</span>      <span class="number">608</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">44880</span>    <span class="number">44880</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown     <span class="number">4924</span>     <span class="number">4924</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">210514</span>   <span class="number">165348</span>    <span class="number">28500</span>        <span class="number">0</span>   <span class="number">108702</span>    <span class="number">87576</span>    <span class="number">21125</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">43572</span></span><br><span class="line">         Native Heap:    <span class="number">25080</span></span><br><span class="line">                Code:    <span class="number">28120</span></span><br><span class="line">               Stack:     <span class="number">1516</span></span><br><span class="line">            Graphics:    <span class="number">85884</span></span><br><span class="line">       Private Other:     <span class="number">9676</span></span><br><span class="line">              System:    <span class="number">16666</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">210514</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿›å…¥è´Ÿä¸€å±"><a href="#è¿›å…¥è´Ÿä¸€å±" class="headerlink" title="è¿›å…¥è´Ÿä¸€å±"></a>è¿›å…¥è´Ÿä¸€å±</h3><blockquote>
<p>æœªç‚¹å‡»è§¦å‘ä»»ä½•åŠ¨ç”»</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">16257</span> [com..test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">25583</span>    <span class="number">25548</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">43264</span>    <span class="number">37267</span>     <span class="number">5996</span></span><br><span class="line">  Dalvik Heap    <span class="number">45619</span>    <span class="number">45532</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">65017</span>    <span class="number">57890</span>     <span class="number">7127</span></span><br><span class="line"> Dalvik Other     <span class="number">3900</span>     <span class="number">3900</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack     <span class="number">1520</span>     <span class="number">1520</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">176</span>      <span class="number">140</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">42456</span>    <span class="number">42456</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev      <span class="number">136</span>        <span class="number">0</span>      <span class="number">136</span>        <span class="number">0</span></span><br><span class="line">     .so mmap     <span class="number">9323</span>      <span class="number">320</span>      <span class="number">960</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap     <span class="number">2583</span>        <span class="number">0</span>     <span class="number">2104</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">173</span>        <span class="number">0</span>      <span class="number">128</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">30308</span>       <span class="number">48</span>    <span class="number">24112</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">3297</span>        <span class="number">0</span>     <span class="number">1284</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">2015</span>     <span class="number">1540</span>      <span class="number">272</span>        <span class="number">0</span></span><br><span class="line">   Other mmap     <span class="number">1223</span>        <span class="number">8</span>      <span class="number">696</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">53520</span>    <span class="number">53520</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown     <span class="number">4924</span>     <span class="number">4924</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">226756</span>   <span class="number">179456</span>    <span class="number">29692</span>        <span class="number">0</span>   <span class="number">108281</span>    <span class="number">95157</span>    <span class="number">13123</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">47344</span></span><br><span class="line">         Native Heap:    <span class="number">25548</span></span><br><span class="line">                Code:    <span class="number">28956</span></span><br><span class="line">               Stack:     <span class="number">1520</span></span><br><span class="line">            Graphics:    <span class="number">95976</span></span><br><span class="line">       Private Other:     <span class="number">9804</span></span><br><span class="line">              System:    <span class="number">17608</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">226756</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿›å…¥3Dæ—¶é’Ÿ"><a href="#è¿›å…¥3Dæ—¶é’Ÿ" class="headerlink" title="è¿›å…¥3Dæ—¶é’Ÿ"></a>è¿›å…¥3Dæ—¶é’Ÿ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">16257</span> [com.org.test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">25243</span>    <span class="number">25216</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">43776</span>    <span class="number">36699</span>     <span class="number">7076</span></span><br><span class="line">  Dalvik Heap    <span class="number">42553</span>    <span class="number">42480</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">66333</span>    <span class="number">50306</span>    <span class="number">16027</span></span><br><span class="line"> Dalvik Other     <span class="number">3692</span>     <span class="number">3692</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack     <span class="number">1532</span>     <span class="number">1532</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">176</span>      <span class="number">140</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">42884</span>    <span class="number">42884</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev      <span class="number">136</span>        <span class="number">0</span>      <span class="number">136</span>        <span class="number">0</span></span><br><span class="line">     .so mmap     <span class="number">8622</span>      <span class="number">320</span>      <span class="number">836</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap     <span class="number">2549</span>        <span class="number">0</span>     <span class="number">2108</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">173</span>        <span class="number">0</span>      <span class="number">128</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">29687</span>       <span class="number">48</span>    <span class="number">23884</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">3646</span>        <span class="number">0</span>     <span class="number">1660</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">2539</span>     <span class="number">1564</span>      <span class="number">792</span>        <span class="number">0</span></span><br><span class="line">   Other mmap     <span class="number">1077</span>        <span class="number">8</span>      <span class="number">608</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">36240</span>    <span class="number">36240</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown     <span class="number">4924</span>     <span class="number">4924</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">205673</span>   <span class="number">159048</span>    <span class="number">30152</span>        <span class="number">0</span>   <span class="number">110109</span>    <span class="number">87005</span>    <span class="number">23103</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">44836</span></span><br><span class="line">         Native Heap:    <span class="number">25216</span></span><br><span class="line">                Code:    <span class="number">28984</span></span><br><span class="line">               Stack:     <span class="number">1532</span></span><br><span class="line">            Graphics:    <span class="number">79124</span></span><br><span class="line">       Private Other:     <span class="number">9508</span></span><br><span class="line">              System:    <span class="number">16473</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">205673</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿›å…¥AllApps"><a href="#è¿›å…¥AllApps" class="headerlink" title="è¿›å…¥AllApps"></a>è¿›å…¥AllApps</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">16257</span> [com.org.test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">25539</span>    <span class="number">25512</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">43776</span>    <span class="number">37873</span>     <span class="number">5902</span></span><br><span class="line">  Dalvik Heap    <span class="number">45413</span>    <span class="number">45340</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">66146</span>    <span class="number">57815</span>     <span class="number">8331</span></span><br><span class="line"> Dalvik Other     <span class="number">3960</span>     <span class="number">3960</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack     <span class="number">1532</span>     <span class="number">1532</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">176</span>      <span class="number">140</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">39380</span>    <span class="number">39380</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev      <span class="number">136</span>        <span class="number">0</span>      <span class="number">136</span>        <span class="number">0</span></span><br><span class="line">     .so mmap     <span class="number">8620</span>      <span class="number">320</span>      <span class="number">836</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap     <span class="number">2549</span>        <span class="number">0</span>     <span class="number">2108</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">173</span>        <span class="number">0</span>      <span class="number">128</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">29887</span>       <span class="number">48</span>    <span class="number">24052</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">3646</span>        <span class="number">0</span>     <span class="number">1648</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">2558</span>     <span class="number">1584</span>      <span class="number">792</span>        <span class="number">0</span></span><br><span class="line">   Other mmap     <span class="number">1127</span>        <span class="number">8</span>      <span class="number">636</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">44880</span>    <span class="number">44880</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown     <span class="number">4924</span>     <span class="number">4924</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">214500</span>   <span class="number">167628</span>    <span class="number">30336</span>        <span class="number">0</span>   <span class="number">109922</span>    <span class="number">95688</span>    <span class="number">14233</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">47716</span></span><br><span class="line">         Native Heap:    <span class="number">25512</span></span><br><span class="line">                Code:    <span class="number">29140</span></span><br><span class="line">               Stack:     <span class="number">1532</span></span><br><span class="line">            Graphics:    <span class="number">84260</span></span><br><span class="line">       Private Other:     <span class="number">9804</span></span><br><span class="line">              System:    <span class="number">16536</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">214500</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿›å…¥å¤©æ°”"><a href="#è¿›å…¥å¤©æ°”" class="headerlink" title="è¿›å…¥å¤©æ°”"></a>è¿›å…¥å¤©æ°”</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">16257</span> [com.org.test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">30251</span>    <span class="number">30224</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">50176</span>    <span class="number">46472</span>     <span class="number">3703</span></span><br><span class="line">  Dalvik Heap    <span class="number">56889</span>    <span class="number">56816</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">82047</span>    <span class="number">68387</span>    <span class="number">13660</span></span><br><span class="line"> Dalvik Other     <span class="number">4124</span>     <span class="number">4124</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack     <span class="number">1872</span>     <span class="number">1872</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">228</span>      <span class="number">144</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">48684</span>    <span class="number">48684</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev      <span class="number">136</span>        <span class="number">0</span>      <span class="number">136</span>        <span class="number">0</span></span><br><span class="line">     .so mmap     <span class="number">9119</span>      <span class="number">320</span>     <span class="number">1216</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap     <span class="number">2537</span>        <span class="number">0</span>     <span class="number">2096</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">261</span>        <span class="number">0</span>      <span class="number">216</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">31424</span>       <span class="number">48</span>    <span class="number">25576</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">3819</span>        <span class="number">0</span>     <span class="number">1784</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">2593</span>     <span class="number">1620</span>      <span class="number">792</span>        <span class="number">0</span></span><br><span class="line">   Other mmap     <span class="number">1397</span>        <span class="number">8</span>      <span class="number">852</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">39552</span>    <span class="number">39552</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown     <span class="number">9044</span>     <span class="number">9044</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">241930</span>   <span class="number">192456</span>    <span class="number">32668</span>        <span class="number">0</span>   <span class="number">132223</span>   <span class="number">114859</span>    <span class="number">17363</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">59228</span></span><br><span class="line">         Native Heap:    <span class="number">30224</span></span><br><span class="line">                Code:    <span class="number">31256</span></span><br><span class="line">               Stack:     <span class="number">1872</span></span><br><span class="line">            Graphics:    <span class="number">88236</span></span><br><span class="line">       Private Other:    <span class="number">14308</span></span><br><span class="line">              System:    <span class="number">16806</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">241930</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿›å…¥æœç´¢"><a href="#è¿›å…¥æœç´¢" class="headerlink" title="è¿›å…¥æœç´¢"></a>è¿›å…¥æœç´¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">16257</span> [com.org.test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">30979</span>    <span class="number">30952</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">51712</span>    <span class="number">46697</span>     <span class="number">5014</span></span><br><span class="line">  Dalvik Heap    <span class="number">53559</span>    <span class="number">53488</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">78029</span>    <span class="number">62140</span>    <span class="number">15889</span></span><br><span class="line"> Dalvik Other     <span class="number">4084</span>     <span class="number">4084</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack     <span class="number">1864</span>     <span class="number">1864</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">224</span>      <span class="number">152</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">44948</span>    <span class="number">44948</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev      <span class="number">136</span>        <span class="number">0</span>      <span class="number">136</span>        <span class="number">0</span></span><br><span class="line">     .so mmap     <span class="number">9092</span>      <span class="number">320</span>     <span class="number">1184</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap     <span class="number">1214</span>        <span class="number">0</span>      <span class="number">812</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">224</span>        <span class="number">0</span>      <span class="number">204</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">31530</span>       <span class="number">48</span>    <span class="number">25696</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">4048</span>        <span class="number">0</span>     <span class="number">2056</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">2619</span>     <span class="number">1704</span>      <span class="number">732</span>        <span class="number">0</span></span><br><span class="line">   Other mmap     <span class="number">1449</span>        <span class="number">8</span>      <span class="number">812</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">53520</span>    <span class="number">53520</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown     <span class="number">8700</span>     <span class="number">8700</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">248190</span>   <span class="number">199788</span>    <span class="number">31632</span>        <span class="number">0</span>   <span class="number">129741</span>   <span class="number">108837</span>    <span class="number">20903</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">55924</span></span><br><span class="line">         Native Heap:    <span class="number">30952</span></span><br><span class="line">                Code:    <span class="number">30320</span></span><br><span class="line">               Stack:     <span class="number">1864</span></span><br><span class="line">            Graphics:    <span class="number">98468</span></span><br><span class="line">       Private Other:    <span class="number">13892</span></span><br><span class="line">              System:    <span class="number">16770</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">248190</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>
<h3 id="åº”ç”¨3Dä¸»é¢˜ä¹‹å"><a href="#åº”ç”¨3Dä¸»é¢˜ä¹‹å" class="headerlink" title="åº”ç”¨3Dä¸»é¢˜ä¹‹å"></a>åº”ç”¨3Dä¸»é¢˜ä¹‹å</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">23770</span> [com.org.test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">16450</span>    <span class="number">16424</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">24832</span>    <span class="number">22375</span>     <span class="number">2456</span></span><br><span class="line">  Dalvik Heap    <span class="number">32283</span>    <span class="number">32212</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">57652</span>    <span class="number">46603</span>    <span class="number">11049</span></span><br><span class="line"> Dalvik Other     <span class="number">3352</span>     <span class="number">3352</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack      <span class="number">864</span>      <span class="number">864</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">130</span>      <span class="number">128</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">58872</span>    <span class="number">58872</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev        <span class="number">4</span>        <span class="number">0</span>        <span class="number">4</span>        <span class="number">0</span></span><br><span class="line">     .so mmap     <span class="number">3563</span>      <span class="number">268</span>     <span class="number">1692</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap     <span class="number">1359</span>        <span class="number">0</span>      <span class="number">896</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">114</span>        <span class="number">0</span>      <span class="number">112</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">24990</span>       <span class="number">32</span>    <span class="number">20756</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">3203</span>        <span class="number">0</span>     <span class="number">1672</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">1352</span>     <span class="number">1152</span>       <span class="number">16</span>        <span class="number">0</span></span><br><span class="line">   Other mmap      <span class="number">913</span>        <span class="number">8</span>      <span class="number">716</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">44880</span>    <span class="number">44880</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown      <span class="number">300</span>      <span class="number">300</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">192629</span>   <span class="number">158492</span>    <span class="number">25864</span>        <span class="number">0</span>    <span class="number">82484</span>    <span class="number">68978</span>    <span class="number">13505</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">33380</span></span><br><span class="line">         Native Heap:    <span class="number">16424</span></span><br><span class="line">                Code:    <span class="number">25428</span></span><br><span class="line">               Stack:      <span class="number">864</span></span><br><span class="line">            Graphics:   <span class="number">103752</span></span><br><span class="line">       Private Other:     <span class="number">4508</span></span><br><span class="line">              System:     <span class="number">8273</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">192629</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>
<h3 id="3Dæ¡Œé¢â€”â€”å…³å±"><a href="#3Dæ¡Œé¢â€”â€”å…³å±" class="headerlink" title="3Dæ¡Œé¢â€”â€”å…³å±"></a>3Dæ¡Œé¢â€”â€”å…³å±</h3><blockquote>
<p>é™ç½®1min</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">23770</span> [com.org.test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">20416</span>    <span class="number">20388</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">33280</span>    <span class="number">27504</span>     <span class="number">5775</span></span><br><span class="line">  Dalvik Heap    <span class="number">34972</span>    <span class="number">34900</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">60660</span>    <span class="number">44452</span>    <span class="number">16208</span></span><br><span class="line"> Dalvik Other     <span class="number">3228</span>     <span class="number">3228</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack     <span class="number">1088</span>     <span class="number">1088</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">150</span>      <span class="number">136</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">59148</span>    <span class="number">59148</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev        <span class="number">8</span>        <span class="number">0</span>        <span class="number">8</span>        <span class="number">0</span></span><br><span class="line">     .so mmap    <span class="number">12463</span>      <span class="number">284</span>     <span class="number">9176</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap     <span class="number">2967</span>        <span class="number">0</span>     <span class="number">2524</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">110</span>        <span class="number">0</span>      <span class="number">108</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">31520</span>       <span class="number">52</span>    <span class="number">26864</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">3170</span>        <span class="number">0</span>     <span class="number">1560</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">1701</span>     <span class="number">1348</span>       <span class="number">20</span>        <span class="number">0</span></span><br><span class="line">   Other mmap     <span class="number">1359</span>        <span class="number">8</span>     <span class="number">1120</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">44880</span>    <span class="number">44880</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown     <span class="number">3652</span>     <span class="number">3652</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">220832</span>   <span class="number">169112</span>    <span class="number">41380</span>        <span class="number">0</span>    <span class="number">93940</span>    <span class="number">71956</span>    <span class="number">21983</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">36268</span></span><br><span class="line">         Native Heap:    <span class="number">20388</span></span><br><span class="line">                Code:    <span class="number">40568</span></span><br><span class="line">               Stack:     <span class="number">1088</span></span><br><span class="line">            Graphics:   <span class="number">104028</span></span><br><span class="line">       Private Other:     <span class="number">8152</span></span><br><span class="line">              System:    <span class="number">10340</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">220832</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>
<h3 id="ä»3Dåˆ‡å›2D"><a href="#ä»3Dåˆ‡å›2D" class="headerlink" title="ä»3Dåˆ‡å›2D"></a>ä»3Dåˆ‡å›2D</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">** MEMINFO in pid <span class="number">23770</span> [com.org.test] **</span><br><span class="line">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span><br><span class="line">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span><br><span class="line">                ------   ------   ------   ------   ------   ------   ------</span><br><span class="line">  Native Heap    <span class="number">23624</span>    <span class="number">23596</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">37376</span>    <span class="number">31068</span>     <span class="number">6307</span></span><br><span class="line">  Dalvik Heap    <span class="number">48127</span>    <span class="number">48056</span>        <span class="number">0</span>        <span class="number">0</span>    <span class="number">69274</span>    <span class="number">53190</span>    <span class="number">16084</span></span><br><span class="line"> Dalvik Other     <span class="number">3368</span>     <span class="number">3368</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        Stack     <span class="number">1256</span>     <span class="number">1256</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">       Ashmem      <span class="number">150</span>      <span class="number">136</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Gfx dev    <span class="number">70896</span>    <span class="number">70896</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">    Other dev        <span class="number">8</span>        <span class="number">0</span>        <span class="number">8</span>        <span class="number">0</span></span><br><span class="line">     .so mmap     <span class="number">4425</span>      <span class="number">320</span>      <span class="number">968</span>        <span class="number">0</span></span><br><span class="line">    .apk mmap      <span class="number">654</span>        <span class="number">0</span>       <span class="number">64</span>        <span class="number">0</span></span><br><span class="line">    .ttf mmap      <span class="number">118</span>        <span class="number">0</span>      <span class="number">108</span>        <span class="number">0</span></span><br><span class="line">    .dex mmap    <span class="number">13328</span>       <span class="number">52</span>     <span class="number">8816</span>        <span class="number">0</span></span><br><span class="line">    .oat mmap     <span class="number">1996</span>        <span class="number">0</span>      <span class="number">380</span>        <span class="number">0</span></span><br><span class="line">    .art mmap     <span class="number">2020</span>     <span class="number">1440</span>      <span class="number">332</span>        <span class="number">0</span></span><br><span class="line">   Other mmap       <span class="number">88</span>        <span class="number">8</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">   EGL mtrack    <span class="number">53520</span>    <span class="number">53520</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">      Unknown     <span class="number">3668</span>     <span class="number">3668</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line">        TOTAL   <span class="number">227246</span>   <span class="number">206316</span>    <span class="number">10676</span>        <span class="number">0</span>   <span class="number">106650</span>    <span class="number">84258</span>    <span class="number">22391</span></span><br><span class="line"></span><br><span class="line"> App Summary</span><br><span class="line">                       Pss(KB)</span><br><span class="line">                        ------</span><br><span class="line">           Java Heap:    <span class="number">49828</span></span><br><span class="line">         Native Heap:    <span class="number">23596</span></span><br><span class="line">                Code:    <span class="number">10708</span></span><br><span class="line">               Stack:     <span class="number">1256</span></span><br><span class="line">            Graphics:   <span class="number">124416</span></span><br><span class="line">       Private Other:     <span class="number">7188</span></span><br><span class="line">              System:    <span class="number">10254</span></span><br><span class="line"></span><br><span class="line">               TOTAL:   <span class="number">227246</span>      <span class="function">TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">------------------------              </span></span><br><span class="line"><span class="function">After 5Min------------------              </span></span><br><span class="line"><span class="function">------------------------              </span></span><br><span class="line"><span class="function">** MEMINFO in pid 23770 [com.org.test] **</span></span><br><span class="line"><span class="function">                   Pss  Private  Private  Swapped     Heap     Heap     Heap</span></span><br><span class="line"><span class="function">                 Total    Dirty    Clean    Dirty     Size    Alloc     Free</span></span><br><span class="line"><span class="function">                ------   ------   ------   ------   ------   ------   ------</span></span><br><span class="line"><span class="function">  Native Heap    23368    23340        0        0    37120    30598     6521</span></span><br><span class="line"><span class="function">  Dalvik Heap    43928    43856        0        0    69379    65551     3828</span></span><br><span class="line"><span class="function"> Dalvik Other     3560     3560        0        0</span></span><br><span class="line"><span class="function">        Stack     1244     1244        0        0</span></span><br><span class="line"><span class="function">       Ashmem      150      136        0        0</span></span><br><span class="line"><span class="function">      Gfx dev    72440    72440        0        0</span></span><br><span class="line"><span class="function">    Other dev        8        0        8        0</span></span><br><span class="line"><span class="function">     .so mmap     3636      320      788        0</span></span><br><span class="line"><span class="function">    .apk mmap      395        0        0        0</span></span><br><span class="line"><span class="function">    .ttf mmap       26        0        8        0</span></span><br><span class="line"><span class="function">    .dex mmap    12470       52     8176        0</span></span><br><span class="line"><span class="function">    .oat mmap     2610        0      260        0</span></span><br><span class="line"><span class="function">    .art mmap     2159     1456       28        0</span></span><br><span class="line"><span class="function">   Other mmap       58        8       20        0</span></span><br><span class="line"><span class="function">   EGL mtrack    44880    44880        0        0</span></span><br><span class="line"><span class="function">      Unknown     3668     3668        0        0</span></span><br><span class="line"><span class="function">        TOTAL   214600   194960     9288        0   106499    96149    10349</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"> App Summary</span></span><br><span class="line"><span class="function">                       <span class="title">Pss</span><span class="params">(KB)</span></span></span><br><span class="line"><span class="function">                        ------</span></span><br><span class="line"><span class="function">           Java Heap:    45340</span></span><br><span class="line"><span class="function">         Native Heap:    23340</span></span><br><span class="line"><span class="function">                Code:     9604</span></span><br><span class="line"><span class="function">               Stack:     1244</span></span><br><span class="line"><span class="function">            Graphics:   117320</span></span><br><span class="line"><span class="function">       Private Other:     7400</span></span><br><span class="line"><span class="function">              System:    10352</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">               TOTAL:   214600      TOTAL <span class="title">SWAP</span> <span class="params">(KB)</span>:        0</span></span><br></pre></td></tr></table></figure>

      

    </div>
    <footer class="article-footer">

      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GL/">GL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Performance/">Performance</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/4/">&laquo; ä¸Šä¸€é¡µ</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/6/">ä¸‹ä¸€é¡µ &raquo;</a>
  </nav>

</section>
        
      </div>
      
        <div align="center" style="margin-top: 30px;"><hr class="hr" style="margin:0px; height:3px;"></div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="/about/" target="_blank">KyleCe</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2015 - 2019 KyleCe All Rights Reserved.</p>

	      
    		<p class="busuanzi_uv">
				è®¿å®¢æ•° : <span id="busuanzi_value_site_uv"></span> |
				è®¿é—®é‡ : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>


  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/scripts.js"></script>


  <script src="/js/home.js"></script>










	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">è®¾ç½®</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              æ­£æ–‡å­—å·å¤§å°
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            æ‚¨å·²è°ƒæ•´é¡µé¢å­—ä½“å¤§å°
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              å¤œé—´æŠ¤çœ¼æ¨¡å¼
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            å¤œé—´æ¨¡å¼å·²ç»å¼€å¯ï¼Œå†æ¬¡å•å‡»æŒ‰é’®å³å¯å…³é—­ 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å…³ äº&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            KyleCe
          </div>
          <div class="panel-body">
            Copyright Â© 2019 KyleCe All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
</body>
</html>